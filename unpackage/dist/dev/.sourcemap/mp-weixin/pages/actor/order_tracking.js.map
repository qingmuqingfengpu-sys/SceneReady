{"version":3,"sources":["uni-app:///main.js","webpack:///D:/学习/大创/艺拍即合/艺拍即合/pages/actor/order_tracking.vue?e329","webpack:///D:/学习/大创/艺拍即合/艺拍即合/pages/actor/order_tracking.vue?f836","webpack:///D:/学习/大创/艺拍即合/艺拍即合/pages/actor/order_tracking.vue?d832","webpack:///D:/学习/大创/艺拍即合/艺拍即合/pages/actor/order_tracking.vue?2fb7","uni-app:///pages/actor/order_tracking.vue","webpack:///D:/学习/大创/艺拍即合/艺拍即合/pages/actor/order_tracking.vue?a1fc","webpack:///D:/学习/大创/艺拍即合/艺拍即合/pages/actor/order_tracking.vue?6c44"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","data","orderId","order","crewInfo","mapCenter","latitude","longitude","myLocation","meetingLocation","mapScale","markers","polyline","circles","statusText","distanceText","isCheckedIn","isCompleted","canCheckIn","checkinTime","trackTimer","distanceToMeeting","onLoad","onUnload","methods","loadOrderInfo","db","res","console","loadCrewInfo","nickname","avatar","mobile","startTracking","stopTracking","clearInterval","getMyLocation","uni","type","success","fail","centerToMyLocation","onRegionChange","updateMapElements","newMarkers","id","iconPath","width","height","anchor","x","y","callout","content","display","bgColor","color","fontSize","borderRadius","padding","newCircles","radius","fillColor","strokeWidth","calculateDistance","getDistance","Math","submitTrack","checkIn","title","icon","formatDateTime","formatTime","formatPrice","openNavigation","name","address","callCrew","phoneNumber","messageCrew","reportIssue","itemList","completeWork","viewDetail","url"],"mappings":";;;;;;;;;;;;;AAAA;AAE2D;AAC3D;AACA;AAHA;AACAA,EAAE,CAACC,iCAAiC,GAAGC,mBAAmB;AAG1DC,UAAU,CAACC,uBAAI,CAAC,C;;;;;;;;;;;;;ACLhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAuI;AACvI;AACkE;AACL;AACsC;;;AAGnG;AAC+M;AAC/M,gBAAgB,uNAAU;AAC1B,EAAE,oFAAM;AACR,EAAE,qGAAM;AACR,EAAE,8GAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,yGAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA,aAAa,sTAEN;AACP,KAAK;AACL;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;AC9CA;AAAA;AAAA;AAAA;AAA0zB,CAAgB,00BAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;eC6H90B;EACAC;IACA;MACAC;MACAC;MACAC;MACAC;QACAC;QACAC;MACA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;IACA;EACA;EAEAC;IACA;MACA;MACA;MACA;IACA;EACA;EAEAC;IACA;EACA;EAEAC;IACAC;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA;gBAEAC;gBAAA;gBAAA,OACAA;cAAA;gBAAAC;gBAAA,MAEAA;kBAAA;kBAAA;gBAAA;gBACA;;gBAEA;gBACA;kBACA;oBACArB;oBACAC;kBACA;kBACA;gBACA;;gBAEA;gBACA;gBACA;;gBAEA;gBAAA,KACA;kBAAA;kBAAA;gBAAA;gBAAA;gBAAA,OACA;cAAA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAIAqB;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IAEAC;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA;gBAEAH;gBAAA;gBAAA,OACAA;kBACAI;kBACAC;kBACAC;gBACA;cAAA;gBAJAL;gBAMA;kBACA;gBACA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAEAC;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IAEAK;MAAA;MACA;MACA;;MAEA;MACA;QACA;QACA;MACA;IACA;IAEAC;MACA;QACAC;QACA;MACA;IACA;IAEAC;MAAA;MACAC;QACAC;QACAC;UACA;YACAjC;YACAC;UACA;UACA;UACA;UACA;QACA;QACAiC;UACAZ;QACA;MACA;IACA;IAEAa;MACA;QACA;MACA;QACA;MACA;IACA;IAEAC;MACA;IAAA,CACA;IAEAC;MACA;MACA;;MAEA;MACA;QACAC;UACAC;UACAvC;UACAC;UACAuC;UACAC;UACAC;UACAC;YAAAC;YAAAC;UAAA;UACAC;YACAC;YACAC;YACAC;YACAC;YACAC;YACAC;YACAC;UACA;QACA;;QAEA;QACAC;UACAtD;UACAC;UACAsD;UACAL;UACAM;UACAC;QACA;MACA;MAEA;MACA;IACA;IAEAC;MACA;QACA;MACA;MAEA,gCACA,0BACA,2BACA,+BACA,+BACA;MAEA;;MAEA;MACA;MAEA;QACA;QACA;MACA;QACA;QACA;MACA;QACA;QACA;MACA;QACA;QACA;MACA;IACA;IAEAC;MACA;MACA;MACA;MACA,QACAC,0CACAA,iCACAA,iCACAA;MACA;MACA;IACA;IAEAC;MAAA;MAAA;QAAA;UAAA;YAAA;cAAA;gBAAA,IACA;kBAAA;kBAAA;gBAAA;gBAAA;cAAA;gBAEA;kBACA;kBACA;kBACA;kBACAvC;gBACA;kBACAA;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IACA;IAEAwC;MAAA;MAAA;QAAA;UAAA;YAAA;cAAA;gBAAA,IACA;kBAAA;kBAAA;gBAAA;gBACA/B;kBACAgC;kBACAC;gBACA;gBAAA;cAAA;gBAAA;gBAKAjC;kBAAAgC;gBAAA;;gBAEA;gBACA;gBACA;;gBAEA;gBAAA;gBAAA,OACA;kBAAA;gBAAA;cAAA;gBAEA;gBACA;gBAEAhC;gBACAA;kBACAgC;kBACAC;gBACA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAEAjC;gBACAT;gBACAS;kBACAgC;kBACAC;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IAEAC;MACA;MACA;MACA;MACA;MACA;MACA;MACA;IACA;IAEAC;MACA;MACA;MACA;MACA;MACA;IACA;IAEAC;MACA;MACA;IACA;IAEAC;MACA;QACArC;UACAgC;UACAC;QACA;QACA;MACA;MAEAjC;QACA/B;QACAC;QACAoE;QACAC;MACA;IACA;IAEAC;MACA;QACAxC;UACAyC;QACA;MACA;QACAzC;UACAgC;UACAC;QACA;MACA;IACA;IAEAS;MACA;MACA1C;QACAgC;QACAC;MACA;IACA;IAEAU;MACA3C;QACA4C;QACA1C;UACA;UACA;UACA;UACAF;YACAgC;YACAC;UACA;QACA;MACA;IACA;IAEAY;MAAA;MAAA;QAAA;UAAA;YAAA;cAAA;gBACA7C;kBACAgC;kBACAhB;kBACAd;oBAAA;sBAAA;wBAAA;0BAAA;4BAAA;8BACA;gCACA;gCACA;gCACAF;kCACAgC;kCACAC;gCACA;8BACA;4BAAA;4BAAA;8BAAA;0BAAA;wBAAA;sBAAA;oBAAA,CACA;oBAAA;sBAAA;oBAAA;oBAAA;kBAAA;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IACA;IAEAa;MACA9C;QACA+C;MACA;IACA;EACA;AACA;AAAA,2B;;;;;;;;;;;;;AC/eA;AAAA;AAAA;AAAA;AAAqiD,CAAgB,y/CAAG,EAAC,C;;;;;;;;;;;ACAzjD;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages/actor/order_tracking.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;import '@dcloudio/vue-cli-plugin-uni/packages/uni-cloud/dist/index.js';\nimport Vue from 'vue'\nimport Page from './pages/actor/order_tracking.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./order_tracking.vue?vue&type=template&id=3e7992db&scoped=true&\"\nvar renderjs\nimport script from \"./order_tracking.vue?vue&type=script&lang=js&\"\nexport * from \"./order_tracking.vue?vue&type=script&lang=js&\"\nimport style0 from \"./order_tracking.vue?vue&type=style&index=0&id=3e7992db&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!C:\\\\Program Files\\\\HBuilderX.4.45.2025010502\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3e7992db\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/actor/order_tracking.vue\"\nexport default component.exports","export * from \"-!C:\\\\Program Files\\\\HBuilderX.4.45.2025010502\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!C:\\\\Program Files\\\\HBuilderX.4.45.2025010502\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--17-0!C:\\\\Program Files\\\\HBuilderX.4.45.2025010502\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!C:\\\\Program Files\\\\HBuilderX.4.45.2025010502\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!C:\\\\Program Files\\\\HBuilderX.4.45.2025010502\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!C:\\\\Program Files\\\\HBuilderX.4.45.2025010502\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./order_tracking.vue?vue&type=template&id=3e7992db&scoped=true&\"","var components\ntry {\n  components = {\n    uniIcons: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/uni-icons/components/uni-icons/uni-icons\" */ \"@/uni_modules/uni-icons/components/uni-icons/uni-icons.vue\"\n      )\n    },\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. 排查组件名称拼写是否正确\")\n    console.error(\n      \"2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var m0 = _vm.formatDateTime(_vm.order.work_start_time) || \"待定\"\n  var m1 = _vm.formatPrice(_vm.order.price_amount)\n  var m2 = !!_vm.isCheckedIn ? _vm.formatTime(_vm.checkinTime) : null\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        m0: m0,\n        m1: m1,\n        m2: m2,\n      },\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!C:\\\\Program Files\\\\HBuilderX.4.45.2025010502\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!C:\\\\Program Files\\\\HBuilderX.4.45.2025010502\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--13-1!C:\\\\Program Files\\\\HBuilderX.4.45.2025010502\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!C:\\\\Program Files\\\\HBuilderX.4.45.2025010502\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!C:\\\\Program Files\\\\HBuilderX.4.45.2025010502\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./order_tracking.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!C:\\\\Program Files\\\\HBuilderX.4.45.2025010502\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!C:\\\\Program Files\\\\HBuilderX.4.45.2025010502\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--13-1!C:\\\\Program Files\\\\HBuilderX.4.45.2025010502\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!C:\\\\Program Files\\\\HBuilderX.4.45.2025010502\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!C:\\\\Program Files\\\\HBuilderX.4.45.2025010502\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./order_tracking.vue?vue&type=script&lang=js&\"","<template>\r\n  <view class=\"tracking-page\">\r\n    <!-- 地图区域 -->\r\n    <map\r\n      id=\"trackingMap\"\r\n      class=\"tracking-map\"\r\n      :latitude=\"mapCenter.latitude\"\r\n      :longitude=\"mapCenter.longitude\"\r\n      :scale=\"mapScale\"\r\n      :markers=\"markers\"\r\n      :polyline=\"polyline\"\r\n      :circles=\"circles\"\r\n      :show-location=\"true\"\r\n      @regionchange=\"onRegionChange\"\r\n    >\r\n      <!-- 状态信息覆盖层 -->\r\n      <cover-view class=\"status-overlay\">\r\n        <cover-view class=\"status-card-cover\">\r\n          <cover-view class=\"status-title\">{{ statusText }}</cover-view>\r\n          <cover-view class=\"status-distance\">{{ distanceText }}</cover-view>\r\n        </cover-view>\r\n      </cover-view>\r\n\r\n      <!-- 定位按钮 -->\r\n      <cover-view class=\"location-btn\" @tap=\"centerToMyLocation\">\r\n        <cover-view class=\"location-icon\">O</cover-view>\r\n      </cover-view>\r\n    </map>\r\n\r\n    <!-- 底部信息面板 -->\r\n    <view class=\"info-panel\">\r\n      <!-- 订单信息 -->\r\n      <view class=\"order-info-section\">\r\n        <view class=\"info-row\">\r\n          <uni-icons type=\"location\" size=\"20\" color=\"#FFD700\"></uni-icons>\r\n          <view class=\"info-content\">\r\n            <text class=\"info-label\">集合地点</text>\r\n            <text class=\"info-value\">{{ order.meeting_location_name || '集合地点' }}</text>\r\n          </view>\r\n          <view class=\"nav-btn\" @tap=\"openNavigation\">\r\n            <uni-icons type=\"navigate\" size=\"24\" color=\"#2979FF\"></uni-icons>\r\n          </view>\r\n        </view>\r\n\r\n        <view class=\"info-row\">\r\n          <uni-icons type=\"calendar\" size=\"20\" color=\"#FFD700\"></uni-icons>\r\n          <view class=\"info-content\">\r\n            <text class=\"info-label\">工作时间</text>\r\n            <text class=\"info-value\">{{ formatDateTime(order.work_start_time) || '待定' }}</text>\r\n          </view>\r\n        </view>\r\n\r\n        <view class=\"info-row\">\r\n          <uni-icons type=\"wallet\" size=\"20\" color=\"#FFD700\"></uni-icons>\r\n          <view class=\"info-content\">\r\n            <text class=\"info-label\">工作报酬</text>\r\n            <text class=\"info-value price\">{{ formatPrice(order.price_amount) }}/{{ order.price_unit === 'day' ? '天' : '时' }}</text>\r\n          </view>\r\n        </view>\r\n      </view>\r\n\r\n      <!-- 打卡状态 -->\r\n      <view class=\"checkin-section\">\r\n        <view class=\"checkin-status\">\r\n          <view class=\"status-item\" :class=\"{ done: isCheckedIn }\">\r\n            <view class=\"status-dot\"></view>\r\n            <text>{{ isCheckedIn ? '已打卡' : '待打卡' }}</text>\r\n          </view>\r\n          <view class=\"status-line\" :class=\"{ active: isCheckedIn }\"></view>\r\n          <view class=\"status-item\" :class=\"{ done: isCompleted }\">\r\n            <view class=\"status-dot\"></view>\r\n            <text>{{ isCompleted ? '已完成' : '进行中' }}</text>\r\n          </view>\r\n        </view>\r\n\r\n        <!-- 打卡按钮 -->\r\n        <view class=\"checkin-action\">\r\n          <button\r\n            v-if=\"!isCheckedIn\"\r\n            class=\"checkin-btn\"\r\n            :class=\"{ disabled: !canCheckIn }\"\r\n            :disabled=\"!canCheckIn\"\r\n            @tap=\"checkIn\"\r\n          >\r\n            <uni-icons type=\"checkmarkempty\" size=\"28\" color=\"#000\"></uni-icons>\r\n            <text>{{ canCheckIn ? '打卡签到' : '未到达集合点' }}</text>\r\n          </button>\r\n\r\n          <view v-else class=\"checkin-done\">\r\n            <uni-icons type=\"checkmarkempty\" size=\"24\" color=\"#4CAF50\"></uni-icons>\r\n            <text>打卡时间: {{ formatTime(checkinTime) }}</text>\r\n          </view>\r\n        </view>\r\n      </view>\r\n\r\n      <!-- 剧组联系 -->\r\n      <view class=\"contact-section\">\r\n        <view class=\"contact-info\">\r\n          <image class=\"crew-avatar\" :src=\"crewInfo.avatar || '/static/default-crew.png'\" mode=\"aspectFill\"></image>\r\n          <view class=\"crew-detail\">\r\n            <text class=\"crew-name\">{{ crewInfo.nickname || '剧组' }}</text>\r\n            <text class=\"crew-label\">发布方</text>\r\n          </view>\r\n        </view>\r\n        <view class=\"contact-actions\">\r\n          <view class=\"contact-btn\" @tap=\"callCrew\">\r\n            <uni-icons type=\"phone\" size=\"24\" color=\"#FFD700\"></uni-icons>\r\n          </view>\r\n          <view class=\"contact-btn\" @tap=\"messageCrew\">\r\n            <uni-icons type=\"chat\" size=\"24\" color=\"#FFD700\"></uni-icons>\r\n          </view>\r\n        </view>\r\n      </view>\r\n\r\n      <!-- 操作按钮 -->\r\n      <view class=\"bottom-actions\">\r\n        <button class=\"btn-secondary\" @tap=\"reportIssue\">遇到问题</button>\r\n        <button class=\"btn-primary\" @tap=\"completeWork\" v-if=\"isCheckedIn && !isCompleted\">完成工作</button>\r\n        <button class=\"btn-primary\" @tap=\"viewDetail\" v-else>查看详情</button>\r\n      </view>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  data() {\r\n    return {\r\n      orderId: '',\r\n      order: {},\r\n      crewInfo: {},\r\n      mapCenter: {\r\n        latitude: 29.5630,\r\n        longitude: 106.4650\r\n      },\r\n      myLocation: null,\r\n      meetingLocation: null,\r\n      mapScale: 15,\r\n      markers: [],\r\n      polyline: [],\r\n      circles: [],\r\n      statusText: '前往集合地点',\r\n      distanceText: '距离计算中...',\r\n      isCheckedIn: false,\r\n      isCompleted: false,\r\n      canCheckIn: false,\r\n      checkinTime: null,\r\n      trackTimer: null,\r\n      distanceToMeeting: Infinity\r\n    }\r\n  },\r\n\r\n  onLoad(options) {\r\n    if (options.id) {\r\n      this.orderId = options.id\r\n      this.loadOrderInfo()\r\n      this.startTracking()\r\n    }\r\n  },\r\n\r\n  onUnload() {\r\n    this.stopTracking()\r\n  },\r\n\r\n  methods: {\r\n    async loadOrderInfo() {\r\n      try {\r\n        const db = uniCloud.database()\r\n        const res = await db.collection('orders').doc(this.orderId).get()\r\n\r\n        if (res.result.data && res.result.data.length > 0) {\r\n          this.order = res.result.data[0]\r\n\r\n          // 设置集合地点\r\n          if (this.order.meeting_location) {\r\n            this.meetingLocation = {\r\n              latitude: this.order.meeting_location.coordinates[1],\r\n              longitude: this.order.meeting_location.coordinates[0]\r\n            }\r\n            this.updateMapElements()\r\n          }\r\n\r\n          // 检查打卡状态\r\n          this.isCheckedIn = this.order.actor_checked_in || false\r\n          this.checkinTime = this.order.checkin_time\r\n\r\n          // 加载剧组信息\r\n          if (this.order.publisher_id) {\r\n            await this.loadCrewInfo(this.order.publisher_id)\r\n          }\r\n        }\r\n      } catch (error) {\r\n        console.error('加载订单信息失败:', error)\r\n      }\r\n    },\r\n\r\n    async loadCrewInfo(crewId) {\r\n      try {\r\n        const db = uniCloud.database()\r\n        const res = await db.collection('uni-id-users').doc(crewId).field({\r\n          nickname: true,\r\n          avatar: true,\r\n          mobile: true\r\n        }).get()\r\n\r\n        if (res.result.data && res.result.data.length > 0) {\r\n          this.crewInfo = res.result.data[0]\r\n        }\r\n      } catch (error) {\r\n        console.error('加载剧组信息失败:', error)\r\n      }\r\n    },\r\n\r\n    startTracking() {\r\n      // 立即获取一次位置\r\n      this.getMyLocation()\r\n\r\n      // 定时上报位置\r\n      this.trackTimer = setInterval(() => {\r\n        this.getMyLocation()\r\n        this.submitTrack()\r\n      }, 10000) // 每10秒\r\n    },\r\n\r\n    stopTracking() {\r\n      if (this.trackTimer) {\r\n        clearInterval(this.trackTimer)\r\n        this.trackTimer = null\r\n      }\r\n    },\r\n\r\n    getMyLocation() {\r\n      uni.getLocation({\r\n        type: 'gcj02',\r\n        success: (res) => {\r\n          this.myLocation = {\r\n            latitude: res.latitude,\r\n            longitude: res.longitude\r\n          }\r\n          this.mapCenter = { ...this.myLocation }\r\n          this.updateMapElements()\r\n          this.calculateDistance()\r\n        },\r\n        fail: (err) => {\r\n          console.error('获取位置失败:', err)\r\n        }\r\n      })\r\n    },\r\n\r\n    centerToMyLocation() {\r\n      if (this.myLocation) {\r\n        this.mapCenter = { ...this.myLocation }\r\n      } else {\r\n        this.getMyLocation()\r\n      }\r\n    },\r\n\r\n    onRegionChange(e) {\r\n      // 地图区域变化\r\n    },\r\n\r\n    updateMapElements() {\r\n      const newMarkers = []\r\n      const newCircles = []\r\n\r\n      // 集合地点标记\r\n      if (this.meetingLocation) {\r\n        newMarkers.push({\r\n          id: 1,\r\n          latitude: this.meetingLocation.latitude,\r\n          longitude: this.meetingLocation.longitude,\r\n          iconPath: '/static/icons/location-meeting.png',\r\n          width: 40,\r\n          height: 40,\r\n          anchor: { x: 0.5, y: 1 },\r\n          callout: {\r\n            content: '集合地点',\r\n            display: 'ALWAYS',\r\n            bgColor: '#1E1E1E',\r\n            color: '#FFD700',\r\n            fontSize: 12,\r\n            borderRadius: 8,\r\n            padding: 8\r\n          }\r\n        })\r\n\r\n        // 电子围栏（100米）\r\n        newCircles.push({\r\n          latitude: this.meetingLocation.latitude,\r\n          longitude: this.meetingLocation.longitude,\r\n          radius: 100,\r\n          color: '#FFD70050',\r\n          fillColor: '#FFD70020',\r\n          strokeWidth: 2\r\n        })\r\n      }\r\n\r\n      this.markers = newMarkers\r\n      this.circles = newCircles\r\n    },\r\n\r\n    calculateDistance() {\r\n      if (!this.myLocation || !this.meetingLocation) {\r\n        return\r\n      }\r\n\r\n      const distance = this.getDistance(\r\n        this.myLocation.latitude,\r\n        this.myLocation.longitude,\r\n        this.meetingLocation.latitude,\r\n        this.meetingLocation.longitude\r\n      )\r\n\r\n      this.distanceToMeeting = distance\r\n\r\n      // 判断是否可以打卡（在100米范围内）\r\n      this.canCheckIn = distance <= 100\r\n\r\n      if (this.isCheckedIn) {\r\n        this.statusText = '已签到'\r\n        this.distanceText = '工作进行中'\r\n      } else if (distance <= 100) {\r\n        this.statusText = '已到达'\r\n        this.distanceText = '请打卡签到'\r\n      } else if (distance < 1000) {\r\n        this.statusText = '即将到达'\r\n        this.distanceText = `距离集合点 ${Math.round(distance)}米`\r\n      } else {\r\n        this.statusText = '前往集合点'\r\n        this.distanceText = `距离集合点 ${(distance / 1000).toFixed(1)}公里`\r\n      }\r\n    },\r\n\r\n    getDistance(lat1, lng1, lat2, lng2) {\r\n      const R = 6371000\r\n      const dLat = (lat2 - lat1) * Math.PI / 180\r\n      const dLng = (lng2 - lng1) * Math.PI / 180\r\n      const a =\r\n        Math.sin(dLat / 2) * Math.sin(dLat / 2) +\r\n        Math.cos(lat1 * Math.PI / 180) *\r\n        Math.cos(lat2 * Math.PI / 180) *\r\n        Math.sin(dLng / 2) * Math.sin(dLng / 2)\r\n      const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a))\r\n      return R * c\r\n    },\r\n\r\n    async submitTrack() {\r\n      if (!this.myLocation) return\r\n\r\n      try {\r\n        // TODO: 调用轨迹上报接口\r\n        // const orderCo = uniCloud.importObject('order-co')\r\n        // await orderCo.submitTrack(this.orderId, this.myLocation)\r\n        console.log('上报位置:', this.myLocation)\r\n      } catch (error) {\r\n        console.error('上报轨迹失败:', error)\r\n      }\r\n    },\r\n\r\n    async checkIn() {\r\n      if (!this.canCheckIn) {\r\n        uni.showToast({\r\n          title: '请先到达集合地点',\r\n          icon: 'none'\r\n        })\r\n        return\r\n      }\r\n\r\n      try {\r\n        uni.showLoading({ title: '打卡中...' })\r\n\r\n        // TODO: 调用打卡接口\r\n        // const orderCo = uniCloud.importObject('order-co')\r\n        // await orderCo.checkIn(this.orderId, this.myLocation)\r\n\r\n        // 模拟打卡成功\r\n        await new Promise(resolve => setTimeout(resolve, 1000))\r\n\r\n        this.isCheckedIn = true\r\n        this.checkinTime = Date.now()\r\n\r\n        uni.hideLoading()\r\n        uni.showToast({\r\n          title: '打卡成功',\r\n          icon: 'success'\r\n        })\r\n      } catch (error) {\r\n        uni.hideLoading()\r\n        console.error('打卡失败:', error)\r\n        uni.showToast({\r\n          title: error.message || '打卡失败',\r\n          icon: 'none'\r\n        })\r\n      }\r\n    },\r\n\r\n    formatDateTime(timestamp) {\r\n      if (!timestamp) return ''\r\n      const date = new Date(timestamp)\r\n      const month = String(date.getMonth() + 1).padStart(2, '0')\r\n      const day = String(date.getDate()).padStart(2, '0')\r\n      const hour = String(date.getHours()).padStart(2, '0')\r\n      const minute = String(date.getMinutes()).padStart(2, '0')\r\n      return `${month}-${day} ${hour}:${minute}`\r\n    },\r\n\r\n    formatTime(timestamp) {\r\n      if (!timestamp) return ''\r\n      const date = new Date(timestamp)\r\n      const hour = String(date.getHours()).padStart(2, '0')\r\n      const minute = String(date.getMinutes()).padStart(2, '0')\r\n      return `${hour}:${minute}`\r\n    },\r\n\r\n    formatPrice(amount) {\r\n      if (!amount) return '0'\r\n      return (amount / 100).toFixed(0)\r\n    },\r\n\r\n    openNavigation() {\r\n      if (!this.meetingLocation) {\r\n        uni.showToast({\r\n          title: '地址信息不完整',\r\n          icon: 'none'\r\n        })\r\n        return\r\n      }\r\n\r\n      uni.openLocation({\r\n        latitude: this.meetingLocation.latitude,\r\n        longitude: this.meetingLocation.longitude,\r\n        name: this.order.meeting_location_name,\r\n        address: this.order.meeting_location_name\r\n      })\r\n    },\r\n\r\n    callCrew() {\r\n      if (this.crewInfo.mobile) {\r\n        uni.makePhoneCall({\r\n          phoneNumber: this.crewInfo.mobile\r\n        })\r\n      } else {\r\n        uni.showToast({\r\n          title: '暂无联系方式',\r\n          icon: 'none'\r\n        })\r\n      }\r\n    },\r\n\r\n    messageCrew() {\r\n      // TODO: 消息功能\r\n      uni.showToast({\r\n        title: '消息功能开发中',\r\n        icon: 'none'\r\n      })\r\n    },\r\n\r\n    reportIssue() {\r\n      uni.showActionSheet({\r\n        itemList: ['迟到预警', '无法到达', '安全问题', '其他问题'],\r\n        success: (res) => {\r\n          const issues = ['迟到预警', '无法到达', '安全问题', '其他问题']\r\n          const selected = issues[res.tapIndex]\r\n          // TODO: 提交问题\r\n          uni.showToast({\r\n            title: '已收到反馈',\r\n            icon: 'success'\r\n          })\r\n        }\r\n      })\r\n    },\r\n\r\n    async completeWork() {\r\n      uni.showModal({\r\n        title: '完成工作',\r\n        content: '确认本次工作已完成？',\r\n        success: async (res) => {\r\n          if (res.confirm) {\r\n            // TODO: 调用完成工作接口\r\n            this.isCompleted = true\r\n            uni.showToast({\r\n              title: '已提交完成',\r\n              icon: 'success'\r\n            })\r\n          }\r\n        }\r\n      })\r\n    },\r\n\r\n    viewDetail() {\r\n      uni.navigateTo({\r\n        url: `/pages/actor/job_detail?id=${this.orderId}`\r\n      })\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n@import '@/common/theme.scss';\r\n\r\n.tracking-page {\r\n  width: 100%;\r\n  height: 100vh;\r\n  position: relative;\r\n  background-color: $bg-primary;\r\n}\r\n\r\n.tracking-map {\r\n  width: 100%;\r\n  height: 50vh;\r\n}\r\n\r\n// 状态覆盖层\r\n.status-overlay {\r\n  position: absolute;\r\n  top: 32rpx;\r\n  left: 32rpx;\r\n  right: 32rpx;\r\n}\r\n\r\n.status-card-cover {\r\n  background-color: rgba(30, 30, 30, 0.95);\r\n  border-radius: 16rpx;\r\n  padding: 24rpx 32rpx;\r\n}\r\n\r\n.status-title {\r\n  font-size: 32rpx;\r\n  font-weight: 700;\r\n  color: #FFD700;\r\n  display: block;\r\n}\r\n\r\n.status-distance {\r\n  font-size: 24rpx;\r\n  color: rgba(255, 255, 255, 0.7);\r\n  margin-top: 8rpx;\r\n  display: block;\r\n}\r\n\r\n// 定位按钮\r\n.location-btn {\r\n  position: absolute;\r\n  right: 32rpx;\r\n  bottom: 32rpx;\r\n  width: 80rpx;\r\n  height: 80rpx;\r\n  background-color: rgba(255, 255, 255, 0.95);\r\n  border-radius: 50%;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n}\r\n\r\n.location-icon {\r\n  font-size: 32rpx;\r\n  color: #2979FF;\r\n  font-weight: bold;\r\n}\r\n\r\n// 底部信息面板\r\n.info-panel {\r\n  position: absolute;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  background-color: $bg-secondary;\r\n  border-radius: $border-radius-lg $border-radius-lg 0 0;\r\n  padding: $spacing-lg;\r\n  padding-bottom: calc(#{$spacing-lg} + env(safe-area-inset-bottom));\r\n  max-height: 55vh;\r\n  overflow-y: auto;\r\n}\r\n\r\n// 订单信息区域\r\n.order-info-section {\r\n  padding-bottom: $spacing-base;\r\n  border-bottom: 1rpx solid rgba(255, 255, 255, 0.1);\r\n\r\n  .info-row {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: $spacing-sm;\r\n    padding: $spacing-sm 0;\r\n\r\n    .info-content {\r\n      flex: 1;\r\n      @include flex-column;\r\n      gap: 4rpx;\r\n\r\n      .info-label {\r\n        font-size: $font-size-xs;\r\n        color: $text-secondary;\r\n      }\r\n\r\n      .info-value {\r\n        font-size: $font-size-base;\r\n        color: $text-primary;\r\n\r\n        &.price {\r\n          color: $primary-color;\r\n          font-weight: $font-weight-bold;\r\n          font-family: $font-family-monospace;\r\n        }\r\n      }\r\n    }\r\n\r\n    .nav-btn {\r\n      width: 80rpx;\r\n      height: 80rpx;\r\n      @include flex-center;\r\n      background-color: $bg-tertiary;\r\n      border-radius: 50%;\r\n\r\n      &:active {\r\n        opacity: 0.8;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n// 打卡区域\r\n.checkin-section {\r\n  padding: $spacing-lg 0;\r\n  border-bottom: 1rpx solid rgba(255, 255, 255, 0.1);\r\n}\r\n\r\n.checkin-status {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  margin-bottom: $spacing-lg;\r\n\r\n  .status-item {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: $spacing-xs;\r\n\r\n    .status-dot {\r\n      width: 24rpx;\r\n      height: 24rpx;\r\n      border-radius: 50%;\r\n      background-color: $gray-4;\r\n      border: 4rpx solid $gray-3;\r\n    }\r\n\r\n    text {\r\n      font-size: $font-size-sm;\r\n      color: $text-secondary;\r\n    }\r\n\r\n    &.done {\r\n      .status-dot {\r\n        background-color: $success-color;\r\n        border-color: $success-color;\r\n      }\r\n\r\n      text {\r\n        color: $success-color;\r\n      }\r\n    }\r\n  }\r\n\r\n  .status-line {\r\n    width: 100rpx;\r\n    height: 4rpx;\r\n    background-color: $gray-4;\r\n    margin: 0 $spacing-sm;\r\n\r\n    &.active {\r\n      background-color: $success-color;\r\n    }\r\n  }\r\n}\r\n\r\n.checkin-action {\r\n  @include flex-center;\r\n}\r\n\r\n.checkin-btn {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  gap: $spacing-sm;\r\n  width: 100%;\r\n  height: 100rpx;\r\n  @include button-primary;\r\n  font-size: $font-size-lg;\r\n\r\n  &.disabled {\r\n    opacity: 0.5;\r\n    background: $gray-4;\r\n  }\r\n}\r\n\r\n.checkin-done {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: $spacing-sm;\r\n  padding: $spacing-base;\r\n  background-color: rgba($success-color, 0.1);\r\n  border-radius: $border-radius-base;\r\n\r\n  text {\r\n    font-size: $font-size-base;\r\n    color: $success-color;\r\n  }\r\n}\r\n\r\n// 联系区域\r\n.contact-section {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  padding: $spacing-base 0;\r\n  border-bottom: 1rpx solid rgba(255, 255, 255, 0.1);\r\n\r\n  .contact-info {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: $spacing-sm;\r\n\r\n    .crew-avatar {\r\n      width: 80rpx;\r\n      height: 80rpx;\r\n      border-radius: 50%;\r\n      background-color: $gray-4;\r\n    }\r\n\r\n    .crew-detail {\r\n      @include flex-column;\r\n      gap: 4rpx;\r\n\r\n      .crew-name {\r\n        font-size: $font-size-base;\r\n        font-weight: $font-weight-bold;\r\n        color: $text-primary;\r\n      }\r\n\r\n      .crew-label {\r\n        font-size: $font-size-xs;\r\n        color: $text-secondary;\r\n      }\r\n    }\r\n  }\r\n\r\n  .contact-actions {\r\n    display: flex;\r\n    gap: $spacing-sm;\r\n\r\n    .contact-btn {\r\n      width: 80rpx;\r\n      height: 80rpx;\r\n      @include flex-center;\r\n      background-color: $bg-tertiary;\r\n      border-radius: 50%;\r\n\r\n      &:active {\r\n        opacity: 0.8;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n// 底部操作\r\n.bottom-actions {\r\n  display: flex;\r\n  gap: $spacing-base;\r\n  margin-top: $spacing-base;\r\n\r\n  button {\r\n    flex: 1;\r\n    height: 88rpx;\r\n    line-height: 88rpx;\r\n    border-radius: $border-radius-base;\r\n    font-size: $font-size-base;\r\n    font-weight: $font-weight-bold;\r\n  }\r\n\r\n  .btn-primary {\r\n    @include button-primary;\r\n  }\r\n\r\n  .btn-secondary {\r\n    @include button-secondary;\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!C:\\\\Program Files\\\\HBuilderX.4.45.2025010502\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!C:\\\\Program Files\\\\HBuilderX.4.45.2025010502\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-1!C:\\\\Program Files\\\\HBuilderX.4.45.2025010502\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!C:\\\\Program Files\\\\HBuilderX.4.45.2025010502\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-2!C:\\\\Program Files\\\\HBuilderX.4.45.2025010502\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!C:\\\\Program Files\\\\HBuilderX.4.45.2025010502\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\sass-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-4!C:\\\\Program Files\\\\HBuilderX.4.45.2025010502\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!C:\\\\Program Files\\\\HBuilderX.4.45.2025010502\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!C:\\\\Program Files\\\\HBuilderX.4.45.2025010502\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./order_tracking.vue?vue&type=style&index=0&id=3e7992db&lang=scss&scoped=true&\"; export default mod; export * from \"-!C:\\\\Program Files\\\\HBuilderX.4.45.2025010502\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!C:\\\\Program Files\\\\HBuilderX.4.45.2025010502\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-1!C:\\\\Program Files\\\\HBuilderX.4.45.2025010502\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!C:\\\\Program Files\\\\HBuilderX.4.45.2025010502\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-2!C:\\\\Program Files\\\\HBuilderX.4.45.2025010502\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!C:\\\\Program Files\\\\HBuilderX.4.45.2025010502\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\sass-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-4!C:\\\\Program Files\\\\HBuilderX.4.45.2025010502\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!C:\\\\Program Files\\\\HBuilderX.4.45.2025010502\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!C:\\\\Program Files\\\\HBuilderX.4.45.2025010502\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./order_tracking.vue?vue&type=style&index=0&id=3e7992db&lang=scss&scoped=true&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1766155824609\n      var cssReload = require(\"C:/Program Files/HBuilderX.4.45.2025010502/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"/\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}