{"version":3,"sources":["webpack:///D:/SceneReady/SceneReady-main/uni_modules/uni-id-pages/components/uni-id-pages-fab-login/uni-id-pages-fab-login.vue?4f78","webpack:///D:/SceneReady/SceneReady-main/uni_modules/uni-id-pages/components/uni-id-pages-fab-login/uni-id-pages-fab-login.vue?a11b","webpack:///D:/SceneReady/SceneReady-main/uni_modules/uni-id-pages/components/uni-id-pages-fab-login/uni-id-pages-fab-login.vue?1844","webpack:///D:/SceneReady/SceneReady-main/uni_modules/uni-id-pages/components/uni-id-pages-fab-login/uni-id-pages-fab-login.vue?fafc","uni-app:///uni_modules/uni-id-pages/components/uni-id-pages-fab-login/uni-id-pages-fab-login.vue","webpack:///D:/SceneReady/SceneReady-main/uni_modules/uni-id-pages/components/uni-id-pages-fab-login/uni-id-pages-fab-login.vue?0469","webpack:///D:/SceneReady/SceneReady-main/uni_modules/uni-id-pages/components/uni-id-pages-fab-login/uni-id-pages-fab-login.vue?af15"],"names":["computed","agreements","config","serviceUrl","privacyUrl","url","title","agree","get","set","data","servicesList","univerifyStyle","watch","created","loginTypes","id","logo","path","item","methods","getParentComponent","setUserInfo","console","getRoute","toPage","uni","animationType","complete","getRoleText","login_before","navigateBack","options","icon","duration","selectedRole","roleText","content","confirmText","cancelText","success","resolve","confirmed","needAgreements","type","agreementsRef","mask","closeUniverify","univerifyManager","clickAnotherButtons","onButtonsClickFn","checkBoxState","setTimeout","fail","phoneCode","provider","res","Object","code","login","params","customUI","uniIdCo","userCo","role","setRoleResult","mutations","autoBack","showToast","catch","showCancel","finally","getUserInfo","e","reject"],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAmI;AACnI;AAC0E;AACL;AACc;;;AAGnF;AACmM;AACnM,gBAAgB,uMAAU;AAC1B,EAAE,4FAAM;AACR,EAAE,iGAAM;AACR,EAAE,0GAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,qGAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACjBA;AAAA;AAAA;AAAA;AAAmxB,CAAgB,kwBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;ACYvyB;AACA;AAAA;AAAA;AACA;AAAA,eACA;EACAA;IACAC;MACA;QACA;MACA;MACA,yBAGAC;QAFAC;QACAC;MAEA;QACAC;QACAC;MACA,GACA;QACAD;QACAC;MACA,EACA;IACA;IACAC;MACAC;QACA;MACA;MACAC;QACA;MACA;IACA;EACA;EACAC;IACA;MACAC,eACA;QACA;QACA;QACA;QACA;MACA,GACA;QACA;QACA;QACA;MACA,EACA;MACAC;QACA;QACA;QACA;UACA;UACA;QACA;QACA;UACA;UACA;UACA;UACA;UACA;UACA;QACA;MACA;IACA;EACA;EACAC;IACAN;MACA;IACA;EACA;EACAO;IAAA;IAAA;MAAA;MAAA;QAAA;UAAA;YAAA;cACAH;cACAI;cAEAJ;gBAGA;kBACA;gBACA;gBASA;cACA;cACA;gBACA;gBACAA,qCAIA;kBAAA,IAHAK;oBACAC;oBACAC;kBAEA;oBACA;sBACA;sBACA;sBACAA;oBACA;kBACA;gBACA;cACA;cAEA;gBACA;gBACA;;gBAEA;gBACA;gBACA,iFACAA,yBACAC;kBACA;gBACA;gBAEA;cACA;YAAA;YAAA;cAAA;UAAA;QAAA;MAAA;IAAA;EACA;EACAC;IACAC;MAEA;IAMA;IACAC;MACAC;IACA;IACAC;MAAA;MACA;MACA;QACA;MACA;MACA;IACA;IACAC;MAAA;MACA,kEACA;QACA;QACAC;MACA;QACAA;MACA;QACA;UACAA;YACArB;YACAsB;YACAC,gCACA;UACA;QACA;UACAF;YACArB;YACAsB;YACAC,gCACA;UACA;QACA;MACA;QACAL;MACA;IACA;IACA;IACAM;MACA;MACA;IACA;IACAC;MAAA;QAAA;MAAA;QAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAAC;gBAAAC;gBACAT;gBAAA,KACA,OACA,UACA,aACA,UACA,YACA,UACA,UACA,SACA;kBAAA;kBAAA;gBAAA;gBAAA,kCACAG;kBACApB;kBACA2B;kBACAC;gBACA;cAAA;gBAGA;gBACAC;gBACAC;gBAAA,MACAA;kBAAA;kBAAA;gBAAA;gBAAA;gBAAA,OACA;kBACAV;oBACApB;oBACA+B;oBACAC;oBACAC;oBACAC;sBACAC;oBACA;kBACA;gBACA;cAAA;gBAVAC;gBAAA,IAWAA;kBAAA;kBAAA;gBAAA;gBAAA;cAAA;gBAAA,KAgCA;kBAAA;kBAAA;gBAAA;gBAAA,kCAIAhB;kBACApB;kBACA2B;kBACAC;gBACA;cAAA;gBAGAS;gBAAA,MACAC;kBAAA;kBAAA;gBAAA;gBACAC;gBAAA,kCACAA;kBACA;gBACA;cAAA;gBAsCAnB;kBACAoB;gBACA;gBAAA,MAEAF;kBAAA;kBAAA;gBAAA;gBAsCAG;kBACArB;kBACAsB;kBACAA;gBACA;gBAzCAA;gBACAC;gBACAC;kBAAA;oBAAA;oBAAA;sBAAA;wBAAA;0BAAA;4BACA3B;4BACA0B;4BAAA;4BAAA,OACAvB;0BAAA;4BAAAyB;4BAEA;4BAMAjC,OACA,8CADAA;4BAEA;8BACA;gCACA;8BACA;8BACA;8BACA6B;4BACA;8BACA;gCACAA;gCACAK;kCACA;gCACA;8BACA;gCACA1B;kCACApB;kCACA2B;kCACAC;gCACA;8BACA;4BACA;0BAAA;0BAAA;4BAAA;wBAAA;sBAAA;oBAAA;kBAAA,CACA;kBAAA,gBAjCAgB;oBAAA;kBAAA;gBAAA;gBAwCAF;gBAAA,kCACAA;kBACA;kBACAR;oBACA;kBACA;kBACAa;oBACA9B;oBACA;sBACAG;oBACA;kBACA;kBACAE;oBAAA;sBAAA;wBAAA;0BAAA;4BAAA;8BACAF;8BACAsB;4BAAA;4BAAA;8BAAA;0BAAA;wBAAA;sBAAA;oBAAA,CACA;oBAAA;sBAAA;oBAAA;oBAAA;kBAAA;gBACA;cAAA;gBAAA,MAGAJ;kBAAA;kBAAA;gBAAA;gBAAA,kCACA;kBACAU;gBACA;cAAA;gBAGA5B;kBACA;kBACA;kBAIAc;oBAAA;sBAAA;sBAAA;wBAAA;0BAAA;4BAAA;8BAAA,MACAI;gCAAA;gCAAA;8BAAA;8BAAA;8BAAA,OACA;gCACAW;8BACA;4BAAA;8BAFAC;8BAGAC;8BACA/B;4BAAA;8BAEA;gCACAgC;8BACA;4BAAA;4BAAA;8BAAA;0BAAA;wBAAA;sBAAA;oBAAA,CACA;oBAAA;sBAAA;oBAAA;oBAAA;kBAAA;kBACAL;oBAAA;sBAAA;wBAAA;0BAAA;4BAAA;8BACA9B;8BACAG;4BAAA;4BAAA;8BAAA;0BAAA;wBAAA;sBAAA;oBAAA,CACA;oBAAA;sBAAA;oBAAA;oBAAA;kBAAA;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IACA;IACAiC;MACApC;QAAAqC;QAAAhB;MAAA;MACA;MACAlB;MAEA;MACA;QACAmC;MACA;MACAC;QAAA;UAAA;UAAA;YAAA;cAAA;gBAAA;kBACAvC;;kBAEA;kBACAY;kBAAA,KACAA;oBAAA;oBAAA;kBAAA;kBAAA;kBAEA4B;kBACAC;kBAAA;kBAAA,OACAD;gBAAA;kBAAAE;kBACA1C;kBAAA;kBAAA;gBAAA;kBAAA;kBAAA;kBAEA;kBACAA;gBAAA;kBAIAG;oBACApB;oBACA2B;oBACAC;kBACA;;kBAIA;kBACAgC;oBAAAC;oBAAAC;kBAAA;kBACA;kBACAhB;oBACA1B;sBACArB;oBACA;kBACA;gBAAA;gBAAA;kBAAA;cAAA;YAAA;UAAA;QAAA,CACA;QAAA;UAAA;QAAA;MAAA,KACAgE;QACA9C;QACAG;UACAW;UACAC;UACAgC;QACA;MACA,GACAC;QACA;UACA7C;QACA;MACA;IACA;IACA8C;MAAA;QAAA;UAAA;YAAA;cAAA;gBAAA,kCACA;kBACA9C,gDACA+C;oBACAjC;sBACAC;oBACA;oBACAY;sBACA3B;wBACAW;wBACAiC;sBACA;sBACAI;oBACA;kBAAA,GACA;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IACA;EACA;AACA;AAAA,2B;;;;;;;;;;;;;AC5dA;AAAA;AAAA;AAAA;AAA87C,CAAgB,y1CAAG,EAAC,C;;;;;;;;;;;ACAl9C;AACA,OAAO,KAAU,EAAE,kBAKd","file":"uni_modules/uni-id-pages/components/uni-id-pages-fab-login/uni-id-pages-fab-login.js","sourcesContent":["import { render, staticRenderFns, recyclableRender, components } from \"./uni-id-pages-fab-login.vue?vue&type=template&id=5810e2be&\"\nvar renderjs\nimport script from \"./uni-id-pages-fab-login.vue?vue&type=script&lang=js&\"\nexport * from \"./uni-id-pages-fab-login.vue?vue&type=script&lang=js&\"\nimport style0 from \"./uni-id-pages-fab-login.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"uni_modules/uni-id-pages/components/uni-id-pages-fab-login/uni-id-pages-fab-login.vue\"\nexport default component.exports","export * from \"-!../../../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./uni-id-pages-fab-login.vue?vue&type=template&id=5810e2be&\"","var components\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  if (!_vm._isMounted) {\n    _vm.e0 = function ($event, item) {\n      var _temp = arguments[arguments.length - 1].currentTarget.dataset,\n        _temp2 = _temp.eventParams || _temp[\"event-params\"],\n        item = _temp2.item\n      var _temp, _temp2\n      item.path ? _vm.toPage(item.path) : _vm.login_before(item.id, false)\n    }\n  }\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./uni-id-pages-fab-login.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./uni-id-pages-fab-login.vue?vue&type=script&lang=js&\"","<template>\n\t<view>\n\t\t<view class=\"fab-login-box\">\n\t\t\t<view class=\"item\" v-for=\"(item,index) in servicesList\" :key=\"index\"\n\t\t\t\t@click=\"item.path?toPage(item.path):login_before(item.id,false)\">\n\t\t\t\t<image class=\"logo\" :src=\"item.logo\" mode=\"scaleToFill\"></image>\n\t\t\t\t<text class=\"login-title\">{{item.text}}</text>\n\t\t\t</view>\n\t\t</view>\n\t</view>\n</template>\n<script>\n\timport config from '@/uni_modules/uni-id-pages/config.js'\n\timport {store,mutations} from '@/uni_modules/uni-id-pages/common/store.js'\n\tlet allServicesList = []\n\texport default {\n\t\tcomputed: {\n\t\t\tagreements() {\n\t\t\t\tif (!config.agreements) {\n\t\t\t\t\treturn []\n\t\t\t\t}\n\t\t\t\tlet {\n\t\t\t\t\tserviceUrl,\n\t\t\t\t\tprivacyUrl\n\t\t\t\t} = config.agreements\n\t\t\t\treturn [{\n\t\t\t\t\t\turl: serviceUrl,\n\t\t\t\t\t\ttitle: \"用户服务协议\"\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\turl: privacyUrl,\n\t\t\t\t\t\ttitle: \"隐私政策条款\"\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\tagree: {\n\t\t\t\tget() {\n\t\t\t\t\treturn this.getParentComponent().agree\n\t\t\t\t},\n\t\t\t\tset(agree) {\n\t\t\t\t\treturn this.getParentComponent().agree = agree\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\tservicesList: [\n\t\t\t\t\t{\n\t\t\t\t\t\t\"id\": \"smsCode\",\n\t\t\t\t\t\t\"text\": \"手机验证码\",\n\t\t\t\t\t\t\"logo\": \"/uni_modules/uni-id-pages/static/login/uni-fab-login/sms.png\",\n\t\t\t\t\t\t\"path\": \"/uni_modules/uni-id-pages/pages/login/login-withoutpwd?type=smsCode\"\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\t\"id\": \"weixin\",\n\t\t\t\t\t\t\"text\": \"微信登录\",\n\t\t\t\t\t\t\"logo\": \"/uni_modules/uni-id-pages/static/login/uni-fab-login/weixin.png\",\n\t\t\t\t\t}\n\t\t\t\t],\n\t\t\t\tuniverifyStyle: {\n\t\t\t\t\t\"fullScreen\": true,\n\t\t\t\t\t\"backgroundColor\": \"#ffffff\",\n\t\t\t\t\t\"buttons\": {\n\t\t\t\t\t\t\"iconWidth\": \"45px\",\n\t\t\t\t\t\t\"list\": []\n\t\t\t\t\t},\n\t\t\t\t\t\"privacyTerms\": {\n\t\t\t\t\t\t\"defaultCheckBoxState\": false,\n\t\t\t\t\t\t\"textColor\": \"#BBBBBB\",\n\t\t\t\t\t\t\"termsColor\": \"#5496E3\",\n\t\t\t\t\t\t\"prefix\": \"我已阅读并同意\",\n\t\t\t\t\t\t\"suffix\": \"并使用本机号码登录\",\n\t\t\t\t\t\t\"privacyItems\": []\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\twatch: {\n\t\t\tagree(agree) {\n\t\t\t\tthis.univerifyStyle.privacyTerms.defaultCheckBoxState = agree\n\t\t\t}\n\t\t},\n\t\tasync created() {\n\t\t\tlet servicesList = this.servicesList\n\t\t\tlet loginTypes = config.loginTypes\n\n\t\t\tservicesList = servicesList.filter(item => {\n\n\t\t\t\t// #ifndef APP\n\t\t\t\tif (item.id == 'apple') {\n\t\t\t\t\treturn false\n\t\t\t\t}\n\t\t\t\t// #endif\n\n\t\t\t\t// #ifdef APP\n\t\t\t\tif (item.id == 'apple' && uni.getSystemInfoSync().osName != 'ios') {\n\t\t\t\t\treturn false\n\t\t\t\t}\n\t\t\t\t// #endif\n\n\t\t\t\treturn loginTypes.includes(item.id)\n\t\t\t})\n\t\t\tif (loginTypes.includes('univerify')) {\n\t\t\t\tthis.univerifyStyle.privacyTerms.privacyItems = this.agreements\n\t\t\t\tservicesList.forEach(({\n\t\t\t\t\tid,\n\t\t\t\t\tlogo,\n\t\t\t\t\tpath\n\t\t\t\t}) => {\n\t\t\t\t\tif (id != 'univerify') {\n\t\t\t\t\t\tthis.univerifyStyle.buttons.list.push({\n\t\t\t\t\t\t\t\"iconPath\": logo,\n\t\t\t\t\t\t\t\"provider\": id,\n\t\t\t\t\t\t\tpath\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}\n\n\t\t\tthis.servicesList = servicesList.filter(item => {\n\t\t\t\tlet path = item.path ? item.path.split('?')[0] : '';\n\t\t\t\tlet currentRoute = this.getRoute(1);\n\n\t\t\t\t// 特殊处理：对于 login-withoutpwd 页面，不过滤带有 type 参数的项\n\t\t\t\t// 因为这些项只是改变当前页面的显示模式，而不是跳转到新页面\n\t\t\t\tif (currentRoute === '/uni_modules/uni-id-pages/pages/login/login-withoutpwd' &&\n\t\t\t\t\tpath === currentRoute &&\n\t\t\t\t\titem.path && item.path.includes('type=')) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\treturn path != currentRoute;\n\t\t\t})\n\t\t},\n\t\tmethods: {\n\t\t\tgetParentComponent(){\n\t\t\t\t// #ifndef H5\n\t\t\t\treturn this.$parent;\n\t\t\t\t// #endif\n\n\t\t\t\t// #ifdef H5\n\t\t\t\treturn this.$parent.$parent;\n\t\t\t\t// #endif\n\t\t\t},\n\t\t\tsetUserInfo(e) {\n\t\t\t\tconsole.log('setUserInfo', e);\n\t\t\t},\n\t\t\tgetRoute(n = 0) {\n\t\t\t\tlet pages = getCurrentPages();\n\t\t\t\tif (n > pages.length) {\n\t\t\t\t\treturn ''\n\t\t\t\t}\n\t\t\t\treturn '/' + pages[pages.length - n].route\n\t\t\t},\n\t\t\ttoPage(path,index = 0) {\n\t\t\t\tif (this.getRoute(1) == path.split('?')[0] && this.getRoute(1) ==\n\t\t\t\t\t'/uni_modules/uni-id-pages/pages/login/login-withoutpwd') {\n\t\t\t\t\tlet loginType = path.split('?')[1].split('=')[1]\n\t\t\t\t\tuni.$emit('uni-id-pages-setLoginType', loginType)\n\t\t\t\t} else if (this.getRoute(2) == path) {\n\t\t\t\t\tuni.navigateBack();\n\t\t\t\t} else if (this.getRoute(1) != path) {\n\t\t\t\t\tif(index === 0){\n\t\t\t\t\t\tuni.navigateTo({\n\t\t\t\t\t\t\turl: path,\n\t\t\t\t\t\t\tanimationType: 'slide-in-left',\n\t\t\t\t\t\t\tcomplete(e) {\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t}else{\n\t\t\t\t\t\tuni.redirectTo({\n\t\t\t\t\t\t\turl: path,\n\t\t\t\t\t\t\tanimationType: 'slide-in-left',\n\t\t\t\t\t\t\tcomplete(e) {\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tconsole.log('unexpected path:' + path);\n\t\t\t\t}\n\t\t\t},\n\t\t\t// 获取角色文本\n\t\t\tgetRoleText() {\n\t\t\t\tconst selectedRole = uni.getStorageSync('selected_role') || ''\n\t\t\t\treturn selectedRole === 'actor' ? '演员' : (selectedRole === 'crew' ? '剧组' : '')\n\t\t\t},\n\t\t\tasync login_before(type, navigateBack = true, options = {}) {\n\t\t\t\tconsole.log(type);\n\t\t\t\tif ([\"qq\",\n\t\t\t\t\t\t\"xiaomi\",\n\t\t\t\t\t\t\"sinaweibo\",\n\t\t\t\t\t\t\"taobao\",\n\t\t\t\t\t\t\"facebook\",\n\t\t\t\t\t\t\"google\",\n\t\t\t\t\t\t\"alipay\",\n\t\t\t\t\t\t\"douyin\",\n\t\t\t\t\t].includes(type)) {\n\t\t\t\t\treturn uni.showToast({\n\t\t\t\t\t\ttitle: '该登录方式暂未实现',\n\t\t\t\t\t\ticon: 'none',\n\t\t\t\t\t\tduration: 3000\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\t// 第三方登录前确认角色（微信等可能是新用户注册）\n\t\t\t\tconst selectedRole = uni.getStorageSync('selected_role') || ''\n\t\t\t\tconst roleText = this.getRoleText()\n\t\t\t\tif (roleText && ['weixin', 'apple', 'qq'].includes(type)) {\n\t\t\t\t\tconst confirmed = await new Promise((resolve) => {\n\t\t\t\t\t\tuni.showModal({\n\t\t\t\t\t\t\ttitle: '登录确认',\n\t\t\t\t\t\t\tcontent: `您即将登录/注册的账号是${roleText}账号，如果是新用户注册后角色不可更改，是否继续？`,\n\t\t\t\t\t\t\tconfirmText: '继续',\n\t\t\t\t\t\t\tcancelText: '取消',\n\t\t\t\t\t\t\tsuccess: (res) => {\n\t\t\t\t\t\t\t\tresolve(res.confirm)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t})\n\t\t\t\t\tif (!confirmed) {\n\t\t\t\t\t\treturn\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// #ifdef APP\n\t\t\t\tlet isAppExist = true\n\t\t\t\tawait new Promise((callback) => {\n\t\t\t\t\tplus.oauth.getServices(oauthServices => {\n\t\t\t\t\t\tlet index = oauthServices.findIndex(e => e.id == type)\n\t\t\t\t\t\tif(index != -1){\n\t\t\t\t\t\t\tisAppExist = oauthServices[index].nativeClient\n\t\t\t\t\t\t\tcallback()\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\treturn uni.showToast({\n\t\t\t\t\t\t\t\ttitle: '当前设备不支持此登录',\n\t\t\t\t\t\t\t\ticon: 'none',\n\t\t\t\t\t\t\t\tduration: 3000\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}, err => {\n\t\t\t\t\t\tthrow new Error('获取服务供应商失败：' + JSON.stringify(err))\n\t\t\t\t\t})\n\t\t\t\t})\n\t\t\t\t// #endif\n\n\t\t\t\tif (\n\t\t\t\t\t// #ifdef APP\n\t\t\t\t\t!isAppExist\n\t\t\t\t\t// #endif\n\n\t\t\t\t\t// #ifndef APP\n\t\t\t\t\t[\"univerify\",\"apple\"].includes(type)\n\t\t\t\t\t// #endif\n\n\t\t\t\t) {\n\t\t\t\t\treturn uni.showToast({\n\t\t\t\t\t\ttitle: '当前设备不支持此登录',\n\t\t\t\t\t\ticon: 'none',\n\t\t\t\t\t\tduration: 3000\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tlet needAgreements = (config?.agreements?.scope || []).includes('register')\n\t\t\t\tif (type != 'univerify' && needAgreements && !this.agree) {\n\t\t\t\t\tlet agreementsRef = this.getParentComponent().$refs.agreements\n\t\t\t\t\treturn agreementsRef.popup(() => {\n\t\t\t\t\t\tthis.login_before(type, navigateBack, options)\n\t\t\t\t\t})\n\t\t\t\t}\n\n\t\t\t\t// #ifdef H5\n\t\t\t\tif(type == 'weixin'){\n\t\t\t\t\t// #ifdef VUE2\n\t\t\t\t\tconst baseUrl = process.env.BASE_URL\n\t\t\t\t\t// #endif\n\t\t\t\t\t// #ifdef VUE3\n\t\t\t\t\tconst baseUrl = import.meta.env.BASE_URL\n\t\t\t\t\t// #endif\n\n\t\t\t\t\tlet redirectUrl = location.protocol +\n\t\t\t\t\t\t'//' +\n\t\t\t\t\t\tlocation.host +\n\t\t\t\t\t\tbaseUrl.replace(/\\/$/, '') +\n\t\t\t\t\t\t(window.location.href.includes('#')?'/#':'') +\n\t\t\t\t\t\t'/uni_modules/uni-id-pages/pages/login/login-withoutpwd?is_weixin_redirect=true&type=weixin'\n\n\t\t\t\t\tredirectUrl=redirectUrl.replace(location.host,config.webWXAuthBackDomain)\n\n\t\t\t\t\tlet ua = window.navigator.userAgent.toLowerCase();\n\t\t\t\t\tif (ua.match(/MicroMessenger/i) == 'micromessenger'){\n\t\t\t\t\t\treturn window.open(`https://open.weixin.qq.com/connect/oauth2/authorize?\n\t\t\t\t\t\t\t\t\tappid=${config.appid.weixin.h5}\n\t\t\t\t\t\t\t\t\t&redirect_uri=${encodeURIComponent(redirectUrl)}\n\t\t\t\t\t\t\t\t\t&response_type=code\n\t\t\t\t\t\t\t\t\t&scope=snsapi_userinfo\n\t\t\t\t\t\t\t\t\t&state=STATE&connect_redirect=1#wechat_redirect`);\n\n\t\t\t\t\t}else{\n\t\t\t\t\t\treturn location.href = `https://open.weixin.qq.com/connect/qrconnect?appid=${config.appid.weixin.web}\n\t\t\t\t\t\t\t\t\t\t&redirect_uri=${encodeURIComponent(redirectUrl)}\n\t\t\t\t\t\t\t\t\t\t&response_type=code&scope=snsapi_login&state=STATE#wechat_redirect`\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// #endif\n\n\t\t\t\tuni.showLoading({\n\t\t\t\t\tmask: true\n\t\t\t\t})\n\n\t\t\t\tif (type == 'univerify') {\n\t\t\t\t\tlet univerifyManager = uni.getUniverifyManager()\n\t\t\t\t\tlet clickAnotherButtons = false\n\t\t\t\t\tlet onButtonsClickFn = async res => {\n\t\t\t\t\t\tconsole.log('provider:', res, res.provider, this.univerifyStyle.buttons.list);\n\t\t\t\t\t\tclickAnotherButtons = true\n\t\t\t\t\t\tlet checkBoxState = await uni.getCheckBoxState();\n\t\t\t\t\t\t// #ifdef VUE2\n\t\t\t\t\t\tthis.agree = checkBoxState[1].state\n\t\t\t\t\t\t// #endif\n\t\t\t\t\t\t// #ifdef VUE3\n\t\t\t\t\t\tthis.agree = checkBoxState.state\n\t\t\t\t\t\t// #endif\n\t\t\t\t\t\tlet {\n\t\t\t\t\t\t\tpath\n\t\t\t\t\t\t} = this.univerifyStyle.buttons.list[res.index]\n\t\t\t\t\t\tif (path) {\n\t\t\t\t\t\t\tif( this.getRoute(1).includes('login-withoutpwd') && path.includes('login-withoutpwd') ){\n\t\t\t\t\t\t\t\tthis.getParentComponent().showCurrentWebview()\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis.toPage(path,1)\n\t\t\t\t\t\t\tcloseUniverify()\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (this.agree) {\n\t\t\t\t\t\t\t\tcloseUniverify()\n\t\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\t\tthis.login_before(res.provider)\n\t\t\t\t\t\t\t\t}, 500)\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\t\ttitle: \"你未同意隐私政策协议\",\n\t\t\t\t\t\t\t\t\ticon: 'none',\n\t\t\t\t\t\t\t\t\tduration: 3000\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tfunction closeUniverify() {\n\t\t\t\t\t\tuni.hideLoading()\n\t\t\t\t\t\tuniverifyManager.close()\n\t\t\t\t\t\tuniverifyManager.offButtonsClick(onButtonsClickFn)\n\t\t\t\t\t}\n\t\t\t\t\tuniverifyManager.onButtonsClick(onButtonsClickFn)\n\t\t\t\t\treturn univerifyManager.login({\n\t\t\t\t\t\t\"univerifyStyle\": this.univerifyStyle,\n\t\t\t\t\t\tsuccess: res => {\n\t\t\t\t\t\t\tthis.login(res.authResult, 'univerify')\n\t\t\t\t\t\t},\n\t\t\t\t\t\tfail(err) {\n\t\t\t\t\t\t\tconsole.log(err)\n\t\t\t\t\t\t\tif(!clickAnotherButtons){\n\t\t\t\t\t\t\t\tuni.navigateBack()\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tcomplete: async e => {\n\t\t\t\t\t\t\tuni.hideLoading()\n\t\t\t\t\t\t\tuniverifyManager.offButtonsClick(onButtonsClickFn)\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t}\n\n\t\t\t\tif (type === 'weixinMobile') {\n\t\t\t\t\treturn this.login({\n\t\t\t\t\t\tphoneCode: options.phoneNumberCode\n\t\t\t\t\t}, type)\n\t\t\t\t}\n\n\t\t\t\tuni.login({\n\t\t\t\t\t\"provider\": type,\n\t\t\t\t\t\"onlyAuthorize\": true,\n\t\t\t\t\t// #ifdef APP\n\t\t\t\t\t\"univerifyStyle\": this.univerifyStyle,\n\t\t\t\t\t// #endif\n\t\t\t\t\tsuccess: async e => {\n\t\t\t\t\t\tif (type == 'apple') {\n\t\t\t\t\t\t\tlet res = await this.getUserInfo({\n\t\t\t\t\t\t\t\tprovider: \"apple\"\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\tObject.assign(e.authResult, res.userInfo)\n\t\t\t\t\t\t\tuni.hideLoading()\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.login(type == 'weixin' ? {\n\t\t\t\t\t\t\tcode: e.code\n\t\t\t\t\t\t} : e.authResult, type)\n\t\t\t\t\t},\n\t\t\t\t\tfail: async (err) => {\n\t\t\t\t\t\tconsole.log(err);\n\t\t\t\t\t\tuni.hideLoading()\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t},\n\t\t\tlogin(params, type) {\n\t\t\t\tconsole.log({params,type});\n\t\t\t\t// hideLoading before login request to avoid mismatch\n\t\t\t\tuni.hideLoading();\n\n\t\t\t\tlet action = 'loginBy' + type.trim().replace(type[0], type[0].toUpperCase())\n\t\t\t\tconst uniIdCo = uniCloud.importObject(\"uni-id-co\",{\n\t\t\t\t\tcustomUI:true\n\t\t\t\t})\n\t\t\t\tuniIdCo[action](params).then(async result => {\n\t\t\t\t\tconsole.log('login success:', result);\n\n\t\t\t\t\t// 检查是否需要设置角色（新用户注册的情况）\n\t\t\t\t\tconst selectedRole = uni.getStorageSync('selected_role') || ''\n\t\t\t\t\tif (selectedRole) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tconst userCo = uniCloud.importObject('user-co')\n\t\t\t\t\t\t\tconst role = selectedRole === 'crew' ? 1 : 2 // crew=1, actor=2\n\t\t\t\t\t\t\tconst setRoleResult = await userCo.setRole(role)\n\t\t\t\t\t\t\tconsole.log('角色设置结果:', setRoleResult)\n\t\t\t\t\t\t} catch (err) {\n\t\t\t\t\t\t\t// 可能是老用户已经有角色了，忽略错误\n\t\t\t\t\t\t\tconsole.log('角色设置跳过（可能已存在）:', err.message)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: '登录成功',\n\t\t\t\t\t\ticon: 'none',\n\t\t\t\t\t\tduration: 2000\n\t\t\t\t\t});\n\t\t\t\t\t// #ifdef H5\n\t\t\t\t\tresult.loginType = type\n\t\t\t\t\t// #endif\n\t\t\t\t\t// autoBack: false, showToast: false - 让index.vue的事件监听器控制跳转\n\t\t\t\t\tmutations.loginSuccess({...result, autoBack: false, showToast: false})\n\t\t\t\t\t// 登录成功后跳转到首页，让首页处理角色检查和跳转\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tuni.reLaunch({\n\t\t\t\t\t\t\turl: '/pages/index/index'\n\t\t\t\t\t\t})\n\t\t\t\t\t}, 500)\n\t\t\t\t})\n\t\t\t\t.catch(e=>{\n\t\t\t\t\tconsole.error('login failed:', e);\n\t\t\t\t\tuni.showModal({\n\t\t\t\t\t\tcontent: e.message,\n\t\t\t\t\t\tconfirmText:\"知道了\",\n\t\t\t\t\t\tshowCancel: false\n\t\t\t\t\t});\n\t\t\t\t})\n\t\t\t\t.finally(e => {\n\t\t\t\t\tif (type == 'univerify') {\n\t\t\t\t\t\tuni.closeAuthView()\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t},\n\t\t\tasync getUserInfo(e) {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tuni.getUserInfo({\n\t\t\t\t\t\t...e,\n\t\t\t\t\t\tsuccess: (res) => {\n\t\t\t\t\t\t\tresolve(res);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tfail: (err) => {\n\t\t\t\t\t\t\tuni.showModal({\n\t\t\t\t\t\t\t\tcontent: JSON.stringify(err),\n\t\t\t\t\t\t\t\tshowCancel: false\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\treject(err);\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\t}\n</script>\n\n<style lang=\"scss\">\n\t/* #ifndef APP-NVUE */\n\t.fab-login-box,\n\t.item {\n\t\tdisplay: flex;\n\t\tbox-sizing: border-box;\n\t\tflex-direction: column;\n\t}\n\t/* #endif */\n\n\t.fab-login-box {\n\t\tflex-direction: row;\n\t\tflex-wrap: wrap;\n\t\twidth: 750rpx;\n\t\tjustify-content: space-around;\n\t\tposition: fixed;\n\t\tleft: 0;\n\t}\n\n\t.item {\n\t\tflex-direction: column;\n\t\tjustify-content: center;\n\t\talign-items: center;\n\t\theight: 200rpx;\n\t\tcursor: pointer;\n\t}\n\n\t/* #ifndef APP-NVUE */\n\t@media screen and (min-width: 690px) {\n\t\t.fab-login-box {\n\t\t\tmax-width: 500px;\n\t\t\tmargin-left: calc(50% - 250px);\n\t\t}\n\t\t.item {\n\t\t\theight: 160rpx;\n\t\t}\n\t}\n\n\t@media screen and (max-width: 690px) {\n\t\t.fab-login-box {\n\t\t\tbottom: 10rpx;\n\t\t}\n\t}\n\n\t/* #endif */\n\n\t.logo {\n\t\twidth: 60rpx;\n\t\theight: 60rpx;\n\t\tmax-width: 40px;\n\t\tmax-height: 40px;\n\t\tborder-radius: 100%;\n\t\tborder: solid 1px #F6F6F6;\n\t}\n\n\t.login-title {\n\t\ttext-align: center;\n\t\tmargin-top: 6px;\n\t\tcolor: #999;\n\t\tfont-size: 10px;\n\t\twidth: 70px;\n\t}\n</style>\n","import mod from \"-!../../../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./uni-id-pages-fab-login.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../../../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./uni-id-pages-fab-login.vue?vue&type=style&index=0&lang=scss&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1768460231583\n      var cssReload = require(\"D:/HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"/\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}