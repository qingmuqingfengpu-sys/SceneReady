{"version":3,"sources":["uni-app:///main.js","webpack:///D:/SceneReady/SceneReady-main/pages/crew/index.vue?7cb5","webpack:///D:/SceneReady/SceneReady-main/pages/crew/index.vue?2aae","webpack:///D:/SceneReady/SceneReady-main/pages/crew/index.vue?4cde","webpack:///D:/SceneReady/SceneReady-main/pages/crew/index.vue?f6e3","uni-app:///pages/crew/index.vue","webpack:///D:/SceneReady/SceneReady-main/pages/crew/index.vue?e9a8","webpack:///D:/SceneReady/SceneReady-main/pages/crew/index.vue?61ba"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","data","isLoggedIn","mapCenter","latitude","longitude","mapScale","actorMarkers","drawerHeight","drawerMinHeight","drawerMaxHeight","touchStartY","drawerStartHeight","isDragging","searchKeyword","searchResults","searchLoading","searchTimer","actorList","actorMarkerData","selectedActor","actorsLoading","defaultAvatarPath","pushClientId","pushConnected","markerAnimationDuration","pushMessageHandler","miniProgramPollingTimer","mapContext","regionChangeDebounceTimer","regionChangeDebounceDelay","currentViewport","clusterMarkers","userLocation","userInfo","stats","pending","ongoing","completed","orderList","statusClassMap","computed","crewCreditLevelClass","crewCreditLevel","onLoad","onPullDownRefresh","setTimeout","uni","onShow","onHide","onUnload","clearTimeout","methods","refreshData","getMyLocation","type","isHighAccuracy","highAccuracyExpireTime","success","console","fail","title","icon","onRegionChange","loadActorsByViewport","southwest","northeast","onMarkerTap","loadActors","viewport","orderCo","params","userLongitude","userLatitude","includeOffline","maxDistance","res","skillLabelMap","bodyTypeMap","processedActors","actorLat","actorLng","full","id","_id","nickname","avatar","height","gender","bodyType","credit_score","distance","skills","videoCard","isOnline","lastActiveTime","marker","filter","updateActorMarkers","iconPath","width","anchor","x","y","joinCluster","callout","content","display","bgColor","color","fontSize","borderRadius","padding","onMarkerClusterCreate","textAlign","onMarkerClusterClick","duration","initPushAndSubscribe","getPushClientId","resolve","generateDeviceId","registerPushListener","startMiniProgramPolling","pushLocationCo","subscribeToServer","push_clientid","user_location","role","platform","updateSubscription","is_active","setSubscriptionInactive","unsubscribePush","clearInterval","handlePushMessage","getPlatform","handleLocationUpdate","updates","smoothMoveMarker","markerId","destination","autoRotate","handleActorOnline","actor_info","handleActorOffline","showActorDetail","closeActorDetail","inviteActor","onDrawerTouchStart","onDrawerTouchMove","newHeight","onDrawerTouchEnd","onSearchInput","searchActorsFromApi","keyword","limit","onSearchResultTap","points","clearSearch","checkLoginStatus","requireLogin","confirmText","url","loadUserInfo","uniCloud","loadStats","token","userCo","loadRecentOrders","page","pageSize","goToPostOrder","goToOrderList","goToOrderDetail","goToProfile","getCreditClass","getCreditLevel","getStatusText","formatTime"],"mappings":";;;;;;;;;;;;;AAAA;AAE2D;AAC3D;AACA;AAHA;AACAA,EAAE,CAACC,iCAAiC,GAAGC,mBAAmB;AAG1DC,UAAU,CAACC,eAAI,CAAC,C;;;;;;;;;;;;;ACLhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAA8H;AAC9H;AACyD;AACL;AACsC;;;AAG1F;AAC6L;AAC7L,gBAAgB,uMAAU;AAC1B,EAAE,2EAAM;AACR,EAAE,4FAAM;AACR,EAAE,qGAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,gGAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA,aAAa,sTAEN;AACP,KAAK;AACL;AACA,aAAa,gQAEN;AACP,KAAK;AACL;AACA,aAAa,sNAEN;AACP,KAAK;AACL;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACjGA;AAAA;AAAA;AAAA;AAAouB,CAAgB,ivBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;eC8NxvB;EACAC;IACA;MACA;MACAC;MAEA;MACAC;QACAC;QACAC;MACA;MACAC;MACAC;MAEA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MAEA;MACAC;MACAC;MACAC;MACAC;MAEA;MACAC;MAAA;MACAC;MAAA;MACAC;MACAC;MAEA;MACAC;MAAA;;MAEA;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;;MAEA;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;;MAEA;MACAC;MAAA;;MAEA;MACAC;QACA5B;QACAD;MACA;MAEA;MACA8B;MACAC;QACAC;QACAC;QACAC;MACA;MACAC;MACAC;QACA;QACA;QACA;QACA;QACA;MACA;IACA;EACA;EAEAC;IACAC;MACA;MACA;MACA;MACA;IACA;IACAC;MACA;MACA;IACA;EACA;EAEAC;IAAA;IAAA;MAAA;QAAA;UAAA;YAAA;cACA;cACA;cACA;cACA;cAEA;gBACA;gBACA;gBACA;cACA;YAAA;YAAA;cAAA;UAAA;QAAA;MAAA;IAAA;EACA;EAEAC;IACA;IACA;IACA;MACA;MACA;IACA;IACAC;MACAC;IACA;EACA;EAEA;EACAC;IACA;EACA;EAEA;EACAC;IACA;EACA;EAEA;EACAC;IACA;IACA;IACA;MACAC;MACA;IACA;EACA;EAEAC;IACA;IACAC;MACA;MACA;MACA;QACA;QACA;QACA;MACA;IACA;IAEA;IACAC;MAAA;MACAP;QACAQ;QACAC;QACAC;QACAC;UACA;UACA;UACA;YACArD;YACAD;UACA;UACAuD;UACA;UACA;UACA;QACA;QACAC;UACAD;UACAZ;YACAc;YACAC;UACA;UACA;YACAzD;YACAD;UACA;UACA;UACA;UACA;QACA;MACA;IACA;IAEA;IACA2D;MAAA;MACA;QACA;QACA;UACAZ;QACA;QACA;QACA;UACA;QACA;MACA;IACA;IAEA;IACAa;MAAA;MAAA;QAAA;UAAA;YAAA;cAAA;gBAAA,IACA;kBAAA;kBAAA;gBAAA;gBACAL;gBAAA;cAAA;gBAIA;kBACA;kBACA;oBACAD;sBACA;wBACAO;wBACAC;sBACA;sBACAP;sBACA;sBACA;;sBAEA;sBACA;wBACA;sBACA;oBACA;oBACAC;sBACAD;sBACA;sBACA;oBACA;kBACA;gBACA;kBACAA;kBACA;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IACA;IAEAQ;MACA;MACA;QAAA;MAAA;MACA;QACA;MACA;IACA;IAEA;IACA;IACA;IACAC;MAAA;QAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAAC;gBAAA,MACA;kBAAA;kBAAA;gBAAA;gBAAA;cAAA;gBAAA,KAIA;kBAAA;kBAAA;gBAAA;gBAAA;cAAA;gBACA;gBAAA;gBAGAC;gBACAC;gBAEA;kBACA;kBACAA;oBACA;oBACAN;sBACA7D;sBACAC;oBACA;oBACA6D;sBACA9D;sBACAC;oBACA;oBACA;oBACAmE;oBACAC;oBACAC;kBACA;kBACAf;gBACA;kBACA;kBACAY;oBACAlE;oBACAD;oBACAuE;oBAAA;oBACAD;kBACA;kBACAf;gBACA;gBAAA;gBAAA,OAEAW;cAAA;gBAAAM;gBAEA;kBACA1D;kBAEA2D;oBACA;oBACA;oBACA;oBACA;oBACA;oBACA;oBACA;oBACA;kBACA;kBAEAC;oBACA;oBACA;oBACA;oBACA;kBACA,GAEA;kBACAC;oBACA;oBACA;oBACA;;oBAEA;oBACA;oBACA;oBACA;oBAEA;sBACAC;sBACAC;oBACA;sBACAD;sBACAC;oBACA;sBACAD;sBACAC;oBACA;oBAEA;oBAEA;sBACA;sBACAC;wBACAC;wBACAC;wBACAC;wBACAC;wBACAC;wBACAC;wBACAC;wBACAC;wBACAC;wBACAC;0BAAA;wBAAA;wBACAxF;wBACAC;wBACAwF;wBACAC;wBACAC;sBACA;sBACA;sBACAC;wBACAb;wBACA/E;wBACAC;wBACAiF;wBACAQ;wBACAT;wBACAE;sBACA;oBACA;kBACA;kBACA;kBAAA,CACAU;oBAAA;kBAAA,IAEA;kBACA;oBAAA;kBAAA;kBACA;oBAAA;kBAAA;kBAEAtC;;kBAEA;kBACA;gBACA;kBACA;kBACA;kBACA;gBACA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAEAA;gBACA;gBACA;gBACA;cAAA;gBAAA;gBAEA;gBAAA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IAEA;IACAuC;MAAA;MACA;MACA;QACA;QACA;QACA;QAEA;UACAf;UACA/E;UACAC;UACA8F;UACAC;UACAb;UACAc;YAAAC;YAAAC;UAAA;UACA;UACAC;UACAC;YACAC;YACAC;YACAC;YACAC;YACAC;YACAC;YACAC;UACA;QACA;MACA;IACA;IAEA;IACAC;MACA;MACA;MACA;MACAtD;;MAEA;MACA;QACA;QACA;UACAwB;UACA/E;UACAC;UACA+F;UACAb;UACAkB;YACAC;YACAC;YACAC;YACAC;YACAC;YACAC;YACAC;YACAE;UACA;QACA;MACA;IACA;IAEA;IACAC;MACA;MACA;MACAxD;MAEA;QACA;QACA;QACA;QACA;UACAvD;UACAC;QACA;;QAEA;QACA0C;UACAc;UACAC;UACAsD;QACA;MACA;IACA;IAEA;IAEA;IACAC;MAAA;MAAA;QAAA;UAAA;YAAA;cAAA;gBAAA,MAEA;kBAAA;kBAAA;gBAAA;gBACA1D;gBAAA;cAAA;gBAAA;gBAAA;gBAAA,OAMA;cAAA;gBAEA;gBACA;;gBAEA;gBAAA;gBAAA,OACA;cAAA;gBAEAA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAEAA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IAEA;IACA2D;MAAA;MACA;QA6BA;QACA;QACA;QACA;QACA;QACA;QACA3D;QACA4D;MAUA;IACA;IAEA;IACAC;MACA;MACAzE;MACA;IACA;IAEA;IACA0E;MA8BA;MACA;MACA;IAEA;IAEA;IACAC;MAAA;MACA;MACA;MACA;MACA;MACA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA,IACA;kBAAA;kBAAA;gBAAA;gBAAA;cAAA;gBACA;kBACA;kBACAC,yDACA;kBACA;kBACA;kBACA;kBACA;gBACA;kBACAhE;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA,CACA;IACA;IAEA;IACAiE;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA,IACA;kBAAA;kBAAA;gBAAA;gBACAjE;gBAAA;cAAA;gBAAA;gBAKAgE;gBAAA;gBAAA,OACAA;kBACAE;kBACAxD;kBACAyD;kBACAC;kBACAC;gBACA;cAAA;gBANApD;gBAQA;kBACAjB;gBACA;kBACAA;gBACA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAEAA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IAEA;IACAsE;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA,MACA;kBAAA;kBAAA;gBAAA;gBAAA;cAAA;gBAAA;gBAGAN;gBAAA;gBAAA,OACAA;kBACAO;kBACA7D;kBACAyD;gBACA;cAAA;gBACAnE;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAEAA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IAEA;IACAwE;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA,IACA;kBAAA;kBAAA;gBAAA;gBAAA;cAAA;gBAAA;gBAGAR;gBAAA;gBAAA,OACAA;kBACAO;gBACA;cAAA;gBACAvE;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAEAA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IAEA;IACAyE;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAUA;gBACA;kBACAC;kBACA;gBACA;;gBAGA;gBAAA,KACA;kBAAA;kBAAA;gBAAA;gBAAA;gBAEAV;gBAAA;gBAAA,OACAA;cAAA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAEAhE;cAAA;gBAIA;gBACAA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IACA;IAEA;IACA2E;MACA3E;MAEA;QACAA;QACA;MACA;MAEA;QACA;UACA;UACA;UACA;QAEA;UACA;UACA;UACA;QAEA;UACA;UACA;UACA;QAEA;UACAA;MAAA;IAEA;IAEA;IACA4E;MAKA;MAKA;IACA;IAEA;IACAC;MAAA;MACA;MACA;;MAEA;MAEAC;QACA;UAAArI;UAAAC;QAEA;UACA;QACA;;QAEA;QACA;UAAA;QAAA;QACA;UACA;UACA;;UAEA;UACA;UACA;;UAEA;UACA;QACA;;QAEA;QACA;UAAA;QAAA;QACA;UACA;UACA;QACA;;QAEA;QACA;UAAA;QAAA;QACA;UACA;UACA;QACA;MACA;MAEAsD;IACA;IAEA;IACA+E;MAAA;MACA;QACA/E;QACA;MACA;;MAEA;MACA;MACA;MACA;QACA;MACA;;MAEA;MACA;QACAgF;QACAC;UACAxI;UACAC;QACA;QACA+G;QACAyB;QACAnF;UACA;QAAA,CACA;QACAE;UACA;UACAD;UACA;QACA;MACA;IACA;IAEA;IACAmF;MACA;QAAA1I;QAAAC;QAAA0I;;MAEA;MACA;QAAA;MAAA;MAEA;QACA;QACA;QACA;QACA;MACA;QACA;QACA;UACA5D;UACA/E;UACAC;UACAiF;UACAQ;UACAT;UACAE;QACA;MACA;;MAEA;MACA;MACA5B;IACA;IAEA;IACAqF;MACA;;MAEA;MACA;QAAA;MAAA;MACA;QACA;MACA;MAEA;QAAA;MAAA;MACA;QACA;MACA;;MAEA;MACA;MACArF;IACA;IAEAsF;MACA;MACA;IACA;IAEAC;MACA;IACA;IAEAC;MACA;MACApG;QACAc;QACAC;MACA;IACA;IAEA;IACAsF;MACA;MACA;MACA;IACA;IAEAC;MACA;MAEA;MACA;MACA;MAEA;MAEA;QACAC;MACA;MACA;QACAA;MACA;MAEA;IACA;IAEAC;MACA;MACA;MACA;IACA;IAEA;IACAC;MAAA;MACA;MACA;QACArG;MACA;MAEA;MACA;QACA;QACA;QACA;MACA;;MAEA;MACA;;MAEA;MACA;QACA;MACA;IACA;IAEA;IACAsG;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA,IACAC;kBAAA;kBAAA;gBAAA;gBACA;gBACA;gBAAA;cAAA;gBAAA;gBAKApF,6CAEA;gBACAC;kBACAmF;kBACA;kBACAlF;kBACAC;kBACA;kBACAkF;gBACA;gBAEAhG;gBAAA;gBAAA,OAEAW;cAAA;gBAAAM;gBAEA;kBACA;kBACAC;oBACA;oBACA;oBACA;oBACA;oBACA;oBACA;oBACA;oBACA;kBACA;kBAEAC;oBACA;oBACA;oBACA;oBACA;kBACA;kBAEA;oBACA;oBACA;;oBAEA;oBACA;oBACA;oBACA;oBAEA;sBACAE;sBACAC;oBACA;sBACAD;sBACAC;oBACA;sBACAD;sBACAC;oBACA;oBAEA;sBACAE;sBACAC;sBACAC;sBACAC;sBACAC;sBACAC;sBACAC;sBACAC;sBACAC;sBACAC;wBAAA;sBAAA;sBACAxF;sBACAC;sBACAwF;sBACAC;sBACAC;oBACA;kBACA;kBAEApC;gBACA;kBACA;kBACA;oBACAA;kBACA;gBACA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAEAA;gBACA;gBACAZ;kBACAc;kBACAC;gBACA;cAAA;gBAAA;gBAEA;gBAAA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IAEA;IACA8F;MAAA;MACA;;MAEA;MACA;;MAEA;MACA;QACA;QACA;;QAEA;QACA;QACA;QAEAjG;;QAEA;QACA;UACA;YACAkG;cACAzJ;cACAC;YACA;YACA2G;YACAtD;cACAC;YACA;YACAC;cACAD;YACA;UACA;QACA;MACA;;MAEA;MACA;MACAb;QACA;MACA;IACA;IAEAgH;MACA;MACA;MACA;IACA;IAEA;IACAC;MACA;QACA;QACA;QACA;MACA;QACA;MACA;IACA;IAEAC;MAAA;MACA;MAEAjH;QACAc;QACA6C;QACAuD;QACAvG;UACA;YACAX;YACAA;cACAmH;YACA;UACA;QACA;MACA;MACA;IACA;IAEAC;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA;gBAAA;gBAAA,OAEAC;cAAA;gBAAAxF;gBACA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAEAjB;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IAEA0G;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA;gBAEAC;gBAAA,IACAA;kBAAA;kBAAA;gBAAA;gBAAA;cAAA;gBAEAC;gBAAA;gBAAA,OACAA;cAAA;gBAAA3F;gBAEA;kBACA;oBACAxC;oBACAC;oBACAC;kBACA;kBACA;oBACA;kBACA;gBACA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAEAqB;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IAEA6G;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA;gBAEAF;gBAAA,IACAA;kBAAA;kBAAA;gBAAA;gBAAA;cAAA;gBAEAhG;gBAAA;gBAAA,OACAA;kBACAmG;kBACAC;gBACA;cAAA;gBAHA9F;gBAKA;kBACA;gBACA;kBACA7B;oBACAmH;kBACA;gBACA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAEAvG;gBACA;kBACAZ;oBACAmH;kBACA;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IAEAS;MACA;MACA5H;QACAmH;MACA;IACA;IAEAU;MACA;MACA7H;QACAmH;MACA;IACA;IAEAW;MACA;MACA9H;QACAmH;MACA;IACA;IAEAY;MACA;MACA/H;QACAmH;MACA;IACA;IAEA;IACAa;MACA;MACA;MACA;IACA;IAEAC;MACA;MACA;MACA;MACA;IACA;IAEAC;MACA;QACA;QACA;QACA;QACA;QACA;MACA;MACA;IACA;IAEAC;MACA;MACA;MACA;MAEA;MACA;MACA;MACA;MAEA;IACA;EACA;AACA;AAAA,2B;;;;;;;;;;;;;AC38CA;AAAA;AAAA;AAAA;AAA+4C,CAAgB,g2CAAG,EAAC,C;;;;;;;;;;;ACAn6C;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages/crew/index.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;import '@dcloudio/vue-cli-plugin-uni/packages/uni-cloud/dist/index.js';\nimport Vue from 'vue'\nimport Page from './pages/crew/index.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./index.vue?vue&type=template&id=0e9da1dd&scoped=true&\"\nvar renderjs\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=0e9da1dd&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"0e9da1dd\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/crew/index.vue\"\nexport default component.exports","export * from \"-!../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=template&id=0e9da1dd&scoped=true&\"","var components\ntry {\n  components = {\n    uniIcons: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/uni-icons/components/uni-icons/uni-icons\" */ \"@/uni_modules/uni-icons/components/uni-icons/uni-icons.vue\"\n      )\n    },\n    uniPopup: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/uni-popup/components/uni-popup/uni-popup\" */ \"@/uni_modules/uni-popup/components/uni-popup/uni-popup.vue\"\n      )\n    },\n    customTabbar: function () {\n      return import(\n        /* webpackChunkName: \"components/custom-tabbar/custom-tabbar\" */ \"@/components/custom-tabbar/custom-tabbar.vue\"\n      )\n    },\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. 排查组件名称拼写是否正确\")\n    console.error(\n      \"2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var g0 =\n    _vm.searchKeyword && !_vm.searchLoading && _vm.searchResults.length > 0\n  var g1 = g0 ? _vm.searchResults.length : null\n  var l0 = g0\n    ? _vm.__map(_vm.searchResults, function (actor, __i0__) {\n        var $orig = _vm.__get_orig(actor)\n        var m0 = _vm.getCreditClass(actor.credit_score)\n        return {\n          $orig: $orig,\n          m0: m0,\n        }\n      })\n    : null\n  var g2 = !(_vm.searchKeyword && _vm.searchLoading)\n    ? _vm.searchKeyword && _vm.searchResults.length === 0 && !_vm.searchLoading\n    : null\n  var g3 = !_vm.searchKeyword ? _vm.orderList.length : null\n  var l1 =\n    !_vm.searchKeyword && g3 > 0\n      ? _vm.__map(_vm.orderList.slice(0, 3), function (order, __i1__) {\n          var $orig = _vm.__get_orig(order)\n          var m1 = _vm.getStatusText(order.order_status)\n          var m2 = _vm.formatTime(order.create_time)\n          var g4 = (order.price_amount / 100).toFixed(0)\n          return {\n            $orig: $orig,\n            m1: m1,\n            m2: m2,\n            g4: g4,\n          }\n        })\n      : null\n  if (!_vm._isMounted) {\n    _vm.e0 = function ($event, order) {\n      var _temp = arguments[arguments.length - 1].currentTarget.dataset,\n        _temp2 = _temp.eventParams || _temp[\"event-params\"],\n        order = _temp2.order\n      var _temp, _temp2\n      return _vm.goToOrderDetail(order._id)\n    }\n  }\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        g0: g0,\n        g1: g1,\n        l0: l0,\n        g2: g2,\n        g3: g3,\n        l1: l1,\n      },\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=script&lang=js&\"","<template>\r\n  <view class=\"crew-home-map\">\r\n    <!-- 地图层 -->\r\n    <map\r\n      id=\"crewMap\"\r\n      class=\"map-layer\"\r\n      :latitude=\"mapCenter.latitude\"\r\n      :longitude=\"mapCenter.longitude\"\r\n      :scale=\"mapScale\"\r\n      :markers=\"actorMarkers\"\r\n      :show-location=\"true\"\r\n      :enable-3D=\"false\"\r\n      :enable-overlooking=\"false\"\r\n      @markertap=\"onMarkerTap\"\r\n      @regionchange=\"onRegionChange\"\r\n      @markerClusterCreate=\"onMarkerClusterCreate\"\r\n      @markerClusterClick=\"onMarkerClusterClick\"\r\n    >\r\n    </map>\r\n\r\n    <!-- 底部抽屉 -->\r\n    <view\r\n      class=\"drawer-container\"\r\n      :style=\"{ height: drawerHeight + 'rpx' }\"\r\n      @touchstart=\"onDrawerTouchStart\"\r\n      @touchmove.stop.prevent=\"onDrawerTouchMove\"\r\n      @touchend=\"onDrawerTouchEnd\"\r\n    >\r\n      <!-- 抽屉把手 -->\r\n      <view class=\"drawer-handle-area\">\r\n        <view class=\"drawer-handle\"></view>\r\n      </view>\r\n\r\n      <!-- 抽屉内容 -->\r\n      <scroll-view\r\n        scroll-y\r\n        class=\"drawer-content\"\r\n        :style=\"{ height: (drawerHeight - 60) + 'rpx' }\"\r\n      >\r\n        <!-- 搜索栏 -->\r\n        <view class=\"search-bar\">\r\n          <uni-icons type=\"search\" size=\"20\" color=\"#999\"></uni-icons>\r\n          <input\r\n            class=\"search-input\"\r\n            placeholder=\"搜索演员\"\r\n            placeholder-class=\"search-placeholder\"\r\n            v-model=\"searchKeyword\"\r\n            @input=\"onSearchInput\"\r\n          />\r\n          <view v-if=\"searchKeyword\" class=\"search-clear\" @tap=\"clearSearch\">\r\n            <uni-icons type=\"close\" size=\"16\" color=\"#999\"></uni-icons>\r\n          </view>\r\n        </view>\r\n\r\n        <!-- 搜索结果列表 -->\r\n        <view v-if=\"searchKeyword && !searchLoading && searchResults.length > 0\" class=\"search-results\">\r\n          <view class=\"section-header-compact\">\r\n            <text class=\"section-title-text\">搜索结果</text>\r\n            <text class=\"result-count\">{{ searchResults.length }}人</text>\r\n          </view>\r\n          <view class=\"search-list\">\r\n            <view\r\n              v-for=\"actor in searchResults\"\r\n              :key=\"actor.id\"\r\n              class=\"search-item\"\r\n              @tap=\"onSearchResultTap(actor)\"\r\n            >\r\n              <image class=\"actor-avatar\" :src=\"actor.avatar || '/static/default-avatar.png'\" mode=\"aspectFill\"></image>\r\n              <view class=\"actor-info\">\r\n                <view class=\"actor-name\">{{ actor.nickname }}</view>\r\n                <view class=\"actor-meta\">\r\n                  <text class=\"meta-item\">{{ actor.height }}cm</text>\r\n                  <text class=\"meta-divider\">|</text>\r\n                  <text class=\"meta-item\">{{ actor.distance }}km</text>\r\n                </view>\r\n              </view>\r\n              <view :class=\"['credit-badge', getCreditClass(actor.credit_score)]\">\r\n                {{ actor.credit_score }}\r\n              </view>\r\n            </view>\r\n          </view>\r\n        </view>\r\n\r\n        <!-- 搜索Loading状态 -->\r\n        <view v-if=\"searchKeyword && searchLoading\" class=\"search-loading\">\r\n          <view class=\"loading-spinner\"></view>\r\n          <text class=\"loading-text\">搜索中...</text>\r\n        </view>\r\n\r\n        <!-- 搜索无结果 -->\r\n        <view v-else-if=\"searchKeyword && searchResults.length === 0 && !searchLoading\" class=\"empty-search\">\r\n          <text class=\"empty-text\">未找到匹配的演员</text>\r\n        </view>\r\n\r\n        <!-- 非搜索状态：显示最近订单和信用分 -->\r\n        <view v-if=\"!searchKeyword\" class=\"main-content\">\r\n          <!-- 最近订单 -->\r\n          <view class=\"recent-orders-compact\">\r\n            <view class=\"section-header-compact\">\r\n              <text class=\"section-title-text\">最近订单</text>\r\n              <view class=\"more-link\" @tap=\"goToOrderList\">\r\n                <text>全部</text>\r\n                <uni-icons type=\"forward\" size=\"14\" color=\"#FFD700\"></uni-icons>\r\n              </view>\r\n            </view>\r\n\r\n            <view v-if=\"orderList.length > 0\" class=\"order-list-compact\">\r\n              <view\r\n                v-for=\"order in orderList.slice(0, 3)\"\r\n                :key=\"order._id\"\r\n                class=\"order-item-compact\"\r\n                @tap=\"goToOrderDetail(order._id)\"\r\n              >\r\n                <view class=\"order-header-compact\">\r\n                  <text :class=\"['order-status-compact', statusClassMap[order.order_status]]\">\r\n                    {{ getStatusText(order.order_status) }}\r\n                  </text>\r\n                  <text class=\"order-time-compact\">{{ formatTime(order.create_time) }}</text>\r\n                </view>\r\n                <view class=\"order-content-compact\">\r\n                  <text class=\"order-location\">{{ order.meeting_location_name }}</text>\r\n                  <text class=\"order-price\">{{ (order.price_amount / 100).toFixed(0) }}</text>\r\n                </view>\r\n              </view>\r\n            </view>\r\n            <view v-else class=\"empty-orders-compact\">\r\n              <text class=\"empty-text-compact\">暂无订单</text>\r\n            </view>\r\n          </view>\r\n\r\n          <!-- 信用分 -->\r\n          <view class=\"credit-section-compact\">\r\n            <view class=\"credit-info\">\r\n              <text class=\"credit-title-compact\">信用分</text>\r\n              <view class=\"credit-score-compact\">\r\n                <text class=\"score-value\">{{ userInfo.credit_score_crew || 100 }}</text>\r\n                <text class=\"score-max\">/150</text>\r\n              </view>\r\n            </view>\r\n            <view :class=\"['credit-level-badge', crewCreditLevelClass]\">\r\n              {{ crewCreditLevel }}\r\n            </view>\r\n          </view>\r\n        </view>\r\n      </scroll-view>\r\n    </view>\r\n\r\n    <!-- FAB 悬浮按钮 -->\r\n    <cover-view class=\"fab\" @tap=\"goToPostOrder\">\r\n      <cover-view class=\"fab-bg\"></cover-view>\r\n      <cover-view class=\"fab-icon\">+</cover-view>\r\n    </cover-view>\r\n\r\n    <!-- 演员详情弹窗 -->\r\n    <uni-popup ref=\"actorDetailPopup\" type=\"bottom\" :safe-area=\"true\">\r\n      <view class=\"actor-detail-popup\">\r\n        <view class=\"popup-header\">\r\n          <text class=\"popup-title\">演员资料</text>\r\n          <view class=\"popup-close\" @tap=\"closeActorDetail\">\r\n            <uni-icons type=\"close\" size=\"24\" color=\"#fff\"></uni-icons>\r\n          </view>\r\n        </view>\r\n\r\n        <view v-if=\"selectedActor\" class=\"actor-detail-content\">\r\n          <!-- 视频模卡预览区 -->\r\n          <view class=\"video-card-preview\">\r\n            <video\r\n              v-if=\"selectedActor.videoCard\"\r\n              :src=\"selectedActor.videoCard\"\r\n              :controls=\"true\"\r\n              :autoplay=\"false\"\r\n              :muted=\"true\"\r\n              class=\"video-player\"\r\n            ></video>\r\n            <view v-else class=\"video-placeholder\">\r\n              <uni-icons type=\"videocam\" size=\"48\" color=\"#666\"></uni-icons>\r\n              <text class=\"placeholder-text\">暂无视频模卡</text>\r\n            </view>\r\n          </view>\r\n\r\n          <!-- 详细信息 -->\r\n          <view class=\"detail-info-grid\">\r\n            <view class=\"info-item\">\r\n              <text class=\"info-label\">姓名</text>\r\n              <text class=\"info-value\">{{ selectedActor.nickname }}</text>\r\n            </view>\r\n            <view class=\"info-item\">\r\n              <text class=\"info-label\">性别</text>\r\n              <text class=\"info-value\">{{ selectedActor.gender === 1 ? '男' : '女' }}</text>\r\n            </view>\r\n            <view class=\"info-item\">\r\n              <text class=\"info-label\">身高</text>\r\n              <text class=\"info-value\">{{ selectedActor.height }}cm</text>\r\n            </view>\r\n            <view class=\"info-item\">\r\n              <text class=\"info-label\">体型</text>\r\n              <text class=\"info-value\">{{ selectedActor.bodyType }}</text>\r\n            </view>\r\n          </view>\r\n\r\n          <view class=\"detail-skills\">\r\n            <text class=\"skills-label\">特长技能</text>\r\n            <view class=\"skills-list\">\r\n              <text v-for=\"skill in selectedActor.skills\" :key=\"skill\" class=\"skill-tag-large\">\r\n                {{ skill }}\r\n              </text>\r\n            </view>\r\n          </view>\r\n\r\n          <button class=\"btn-invite\" type=\"primary\" @tap=\"inviteActor\">\r\n            邀请TA接单\r\n          </button>\r\n        </view>\r\n      </view>\r\n    </uni-popup>\r\n\r\n    <!-- 底部 TabBar -->\r\n    <custom-tabbar role=\"crew\" :current=\"0\" @refresh=\"refreshData\"></custom-tabbar>\r\n  </view>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  data() {\r\n    return {\r\n      // 登录状态\r\n      isLoggedIn: false,\r\n\r\n      // 地图相关\r\n      mapCenter: {\r\n        latitude: 29.5630,\r\n        longitude: 106.4650\r\n      },\r\n      mapScale: 15,\r\n      actorMarkers: [],\r\n\r\n      // 抽屉相关\r\n      drawerHeight: 400,\r\n      drawerMinHeight: 280,\r\n      drawerMaxHeight: 1000,\r\n      touchStartY: 0,\r\n      drawerStartHeight: 0,\r\n      isDragging: false,\r\n\r\n      // 搜索\r\n      searchKeyword: '',\r\n      searchResults: [],\r\n      searchLoading: false,\r\n      searchTimer: null,\r\n\r\n      // 演员数据（用于地图标记和搜索）\r\n      actorList: [],              // 完整列表数据（用于搜索和详情展示）\r\n      actorMarkerData: [],        // 轻量化地图标记数据（只含经纬度、ID、头像）\r\n      selectedActor: null,\r\n      actorsLoading: false,\r\n\r\n      // 演员地图显示相关\r\n      defaultAvatarPath: '/static/default-avatar.png', // 默认头像\r\n\r\n      // Uni-Push 2.0 实时位置更新相关\r\n      pushClientId: null,              // 推送客户端ID\r\n      pushConnected: false,            // 推送连接状态\r\n      markerAnimationDuration: 500,    // Marker移动动画时长（毫秒）\r\n      pushMessageHandler: null,        // 推送消息处理函数引用\r\n      miniProgramPollingTimer: null,   // 小程序降级轮询定时器\r\n\r\n      // 地图视口区域查询相关\r\n      mapContext: null,                // 地图上下文\r\n      regionChangeDebounceTimer: null, // 防抖定时器\r\n      regionChangeDebounceDelay: 500,  // 防抖延迟（毫秒）\r\n      currentViewport: null,           // 当前视口边界\r\n\r\n      // 点聚合相关\r\n      clusterMarkers: [],              // 聚合点标记\r\n\r\n      // 用户位置\r\n      userLocation: {\r\n        longitude: null,\r\n        latitude: null\r\n      },\r\n\r\n      // 用户信息\r\n      userInfo: {},\r\n      stats: {\r\n        pending: 0,\r\n        ongoing: 0,\r\n        completed: 0\r\n      },\r\n      orderList: [],\r\n      statusClassMap: {\r\n        0: 'status-pending',\r\n        1: 'status-ongoing',\r\n        2: 'status-payment',\r\n        3: 'status-completed',\r\n        4: 'status-canceled'\r\n      }\r\n    }\r\n  },\r\n\r\n  computed: {\r\n    crewCreditLevelClass() {\r\n      const score = this.userInfo.credit_score_crew || 100\r\n      if (score >= 130) return 'level-gold'\r\n      if (score >= 110) return 'level-silver'\r\n      return 'level-normal'\r\n    },\r\n    crewCreditLevel() {\r\n      const score = this.userInfo.credit_score_crew || 100\r\n      return this.getCreditLevel(score)\r\n    }\r\n  },\r\n\r\n  async onLoad() {\r\n    this.isLoggedIn = this.checkLoginStatus()\r\n    // 初始化地图上下文\r\n    this.mapContext = uni.createMapContext('crewMap', this)\r\n    this.getMyLocation()\r\n\r\n    if (this.isLoggedIn) {\r\n      this.loadUserInfo()\r\n      this.loadStats()\r\n      this.loadRecentOrders()\r\n    }\r\n  },\r\n\r\n  onPullDownRefresh() {\r\n    this.isLoggedIn = this.checkLoginStatus()\r\n    this.loadActors()\r\n    if (this.isLoggedIn) {\r\n      this.loadStats()\r\n      this.loadRecentOrders()\r\n    }\r\n    setTimeout(() => {\r\n      uni.stopPullDownRefresh()\r\n    }, 1000)\r\n  },\r\n\r\n  // 页面显示时订阅推送\r\n  onShow() {\r\n    this.initPushAndSubscribe()\r\n  },\r\n\r\n  // 页面隐藏时标记为非活跃\r\n  onHide() {\r\n    this.setSubscriptionInactive()\r\n  },\r\n\r\n  // 页面卸载时清理资源\r\n  onUnload() {\r\n    this.unsubscribePush()\r\n    // 清理防抖定时器\r\n    if (this.regionChangeDebounceTimer) {\r\n      clearTimeout(this.regionChangeDebounceTimer)\r\n      this.regionChangeDebounceTimer = null\r\n    }\r\n  },\r\n\r\n  methods: {\r\n    // ========== 刷新数据 ==========\r\n    refreshData() {\r\n      this.isLoggedIn = this.checkLoginStatus()\r\n      this.loadActors()\r\n      if (this.isLoggedIn) {\r\n        this.loadUserInfo()\r\n        this.loadStats()\r\n        this.loadRecentOrders()\r\n      }\r\n    },\r\n\r\n    // ========== 地图相关 ==========\r\n    getMyLocation() {\r\n      uni.getLocation({\r\n        type: 'gcj02',\r\n        isHighAccuracy: true,\r\n        highAccuracyExpireTime: 4000,\r\n        success: (res) => {\r\n          this.mapCenter.latitude = res.latitude\r\n          this.mapCenter.longitude = res.longitude\r\n          this.userLocation = {\r\n            longitude: res.longitude,\r\n            latitude: res.latitude\r\n          }\r\n          console.log('定位成功, 精度:', res.accuracy, '米')\r\n          this.loadActors()\r\n          // 获取到位置后初始化推送\r\n          this.initPushAndSubscribe()\r\n        },\r\n        fail: (err) => {\r\n          console.error('获取位置失败:', err)\r\n          uni.showToast({\r\n            title: '定位失败，使用默认位置',\r\n            icon: 'none'\r\n          })\r\n          this.userLocation = {\r\n            longitude: this.mapCenter.longitude,\r\n            latitude: this.mapCenter.latitude\r\n          }\r\n          this.loadActors()\r\n          // 即使使用默认位置也初始化推送\r\n          this.initPushAndSubscribe()\r\n        }\r\n      })\r\n    },\r\n\r\n    // 地图视口变化（带防抖）\r\n    onRegionChange(e) {\r\n      if (e.type === 'end') {\r\n        // 清除之前的防抖定时器\r\n        if (this.regionChangeDebounceTimer) {\r\n          clearTimeout(this.regionChangeDebounceTimer)\r\n        }\r\n        // 设置新的防抖定时器\r\n        this.regionChangeDebounceTimer = setTimeout(() => {\r\n          this.loadActorsByViewport()\r\n        }, this.regionChangeDebounceDelay)\r\n      }\r\n    },\r\n\r\n    // 按视口区域加载演员\r\n    async loadActorsByViewport() {\r\n      if (!this.mapContext) {\r\n        console.warn('mapContext not initialized')\r\n        return\r\n      }\r\n\r\n      try {\r\n        // 获取当前地图视口的西南角和东北角坐标\r\n        this.mapContext.getRegion({\r\n          success: (res) => {\r\n            this.currentViewport = {\r\n              southwest: res.southwest,\r\n              northeast: res.northeast\r\n            }\r\n            console.log('当前视口范围:', this.currentViewport)\r\n            // 使用视口边界加载演员\r\n            this.loadActors(this.currentViewport)\r\n\r\n            // 视口变化时，更新推送订阅范围\r\n            if (this.pushConnected) {\r\n              this.updateSubscription()\r\n            }\r\n          },\r\n          fail: (err) => {\r\n            console.error('获取地图视口失败:', err)\r\n            // 降级为使用中心点+半径方式\r\n            this.loadActors(null)\r\n          }\r\n        })\r\n      } catch (error) {\r\n        console.error('loadActorsByViewport error:', error)\r\n        this.loadActors(null)\r\n      }\r\n    },\r\n\r\n    onMarkerTap(e) {\r\n      const markerId = e.detail.markerId\r\n      const actor = this.actorList.find(a => a.id === markerId)\r\n      if (actor) {\r\n        this.showActorDetail(actor)\r\n      }\r\n    },\r\n\r\n    // 加载演员（用于地图标记和搜索）\r\n    // 显示所有已注册登录的演员：离线显示最后登录位置，在线显示实时位置\r\n    // viewport: { southwest: {latitude, longitude}, northeast: {latitude, longitude} }\r\n    async loadActors(viewport = null) {\r\n      if (!this.userLocation.longitude || !this.userLocation.latitude) {\r\n        return\r\n      }\r\n\r\n      if (this.actorsLoading) return\r\n      this.actorsLoading = true\r\n\r\n      try {\r\n        const orderCo = uniCloud.importObject('order-co')\r\n        let params = {}\r\n\r\n        if (viewport && viewport.southwest && viewport.northeast) {\r\n          // 按视口边界查询（推荐方式）\r\n          params = {\r\n            // 视口边界坐标\r\n            southwest: {\r\n              latitude: viewport.southwest.latitude,\r\n              longitude: viewport.southwest.longitude\r\n            },\r\n            northeast: {\r\n              latitude: viewport.northeast.latitude,\r\n              longitude: viewport.northeast.longitude\r\n            },\r\n            // 仍然传递用户位置用于计算距离\r\n            userLongitude: this.userLocation.longitude,\r\n            userLatitude: this.userLocation.latitude,\r\n            includeOffline: true\r\n          }\r\n          console.log('按视口边界查询演员:', params)\r\n        } else {\r\n          // 降级：按中心点+半径查询\r\n          params = {\r\n            longitude: this.userLocation.longitude,\r\n            latitude: this.userLocation.latitude,\r\n            maxDistance: 10000, // 10km\r\n            includeOffline: true\r\n          }\r\n          console.log('按中心点半径查询演员:', params)\r\n        }\r\n\r\n        const res = await orderCo.getNearbyActors(params)\r\n\r\n        if (res.code === 0 && res.data) {\r\n          const actorList = res.data.list || res.data // 兼容两种返回格式\r\n\r\n          const skillLabelMap = {\r\n            'driving': '开车',\r\n            'dancing': '跳舞',\r\n            'singing': '唱歌',\r\n            'martial_arts': '武术',\r\n            'swimming': '游泳',\r\n            'riding': '骑马',\r\n            'instrument': '乐器',\r\n            'language': '外语'\r\n          }\r\n\r\n          const bodyTypeMap = {\r\n            'slim': '偏瘦',\r\n            'standard': '标准',\r\n            'athletic': '健壮',\r\n            'plump': '偏胖'\r\n          }\r\n\r\n          // 处理演员数据，分离为轻量化标记数据和完整列表数据\r\n          const processedActors = actorList.map((actor, index) => {\r\n            // 处理头像：avatar_file.url > avatar > 默认头像\r\n            const avatarFile = actor.avatar_file\r\n            const avatarUrl = (avatarFile && avatarFile.url) || actor.avatar || this.defaultAvatarPath\r\n\r\n            // 确定演员位置\r\n            const isOnline = actor.online_status === 1\r\n            let actorLat = null\r\n            let actorLng = null\r\n\r\n            if (isOnline && actor.current_location) {\r\n              actorLat = actor.current_location.coordinates[1]\r\n              actorLng = actor.current_location.coordinates[0]\r\n            } else if (actor.last_login_location) {\r\n              actorLat = actor.last_login_location.coordinates[1]\r\n              actorLng = actor.last_login_location.coordinates[0]\r\n            } else if (actor.location) {\r\n              actorLat = actor.location.coordinates[1]\r\n              actorLng = actor.location.coordinates[0]\r\n            }\r\n\r\n            const actorId = actor._id || index + 1\r\n\r\n            return {\r\n              // 完整列表数据\r\n              full: {\r\n                id: actorId,\r\n                _id: actor._id,\r\n                nickname: actor.nickname || '--',\r\n                avatar: avatarUrl,\r\n                height: actor.height || 170,\r\n                gender: actor.gender || 0,\r\n                bodyType: bodyTypeMap[actor.body_type] || actor.body_type || '--',\r\n                credit_score: actor.credit_score_actor || 100,\r\n                distance: actor.distance_km ? parseFloat(actor.distance_km).toFixed(1) : '-',\r\n                skills: (actor.skills || []).map(s => skillLabelMap[s] || s),\r\n                latitude: actorLat,\r\n                longitude: actorLng,\r\n                videoCard: actor.video_card || actor.video_card_url || '',\r\n                isOnline: isOnline,\r\n                lastActiveTime: actor.last_active_time || null\r\n              },\r\n              // 轻量化地图标记数据（只含必要字段）\r\n              marker: {\r\n                id: actorId,\r\n                latitude: actorLat,\r\n                longitude: actorLng,\r\n                avatar: avatarUrl,\r\n                isOnline: isOnline,\r\n                nickname: actor.nickname || '--',\r\n                height: actor.height || 170\r\n              }\r\n            }\r\n          })\r\n          // 过滤掉没有有效坐标的演员\r\n          .filter(item => item.marker.latitude !== null && item.marker.longitude !== null)\r\n\r\n          // 分离数据\r\n          this.actorList = processedActors.map(item => item.full)\r\n          this.actorMarkerData = processedActors.map(item => item.marker)\r\n\r\n          console.log('演员数据加载完成, 列表数据:', this.actorList.length, '条, 标记数据:', this.actorMarkerData.length, '条')\r\n\r\n          // 生成地图标记\r\n          this.updateActorMarkers()\r\n        } else {\r\n          this.actorList = []\r\n          this.actorMarkerData = []\r\n          this.actorMarkers = []\r\n        }\r\n      } catch (error) {\r\n        console.error('加载演员失败:', error)\r\n        this.actorList = []\r\n        this.actorMarkerData = []\r\n        this.actorMarkers = []\r\n      } finally {\r\n        this.actorsLoading = false\r\n      }\r\n    },\r\n\r\n    // 更新地图标记（使用轻量化数据，支持点聚合）\r\n    updateActorMarkers() {\r\n      // 使用轻量化的标记数据生成markers\r\n      this.actorMarkers = this.actorMarkerData.map(marker => {\r\n        const isOnline = marker.isOnline\r\n        const statusText = isOnline ? '[在线]' : '[离线]'\r\n        const calloutColor = isOnline ? '#4CAF50' : '#999999'\r\n\r\n        return {\r\n          id: marker.id,\r\n          latitude: marker.latitude,\r\n          longitude: marker.longitude,\r\n          iconPath: marker.avatar || this.defaultAvatarPath,\r\n          width: 40,\r\n          height: 40,\r\n          anchor: { x: 0.5, y: 0.5 },\r\n          // 启用点聚合\r\n          joinCluster: true,\r\n          callout: {\r\n            content: statusText + ' ' + marker.nickname + ' ' + marker.height + 'cm',\r\n            display: 'BYCLICK',\r\n            bgColor: '#1E1E1E',\r\n            color: calloutColor,\r\n            fontSize: 12,\r\n            borderRadius: 8,\r\n            padding: 6\r\n          }\r\n        }\r\n      })\r\n    },\r\n\r\n    // 点聚合创建事件 - 当标记被聚合时触发\r\n    onMarkerClusterCreate(e) {\r\n      // e.detail.clusters 包含聚合点信息\r\n      // 每个cluster: { clusterId, center: {latitude, longitude}, markerIds: [] }\r\n      const clusters = e.detail.clusters || []\r\n      console.log('点聚合创建:', clusters.length, '个聚合点')\r\n\r\n      // 生成聚合点的自定义标记\r\n      this.clusterMarkers = clusters.map(cluster => {\r\n        const count = cluster.markerIds ? cluster.markerIds.length : 0\r\n        return {\r\n          id: cluster.clusterId,\r\n          latitude: cluster.center.latitude,\r\n          longitude: cluster.center.longitude,\r\n          width: 50,\r\n          height: 50,\r\n          callout: {\r\n            content: count + '位演员',\r\n            display: 'ALWAYS',\r\n            bgColor: '#FFD700',\r\n            color: '#000000',\r\n            fontSize: 12,\r\n            borderRadius: 25,\r\n            padding: 8,\r\n            textAlign: 'center'\r\n          }\r\n        }\r\n      })\r\n    },\r\n\r\n    // 点聚合点击事件 - 当用户点击聚合点时触发\r\n    onMarkerClusterClick(e) {\r\n      // e.detail.cluster 包含被点击的聚合点信息\r\n      const cluster = e.detail.cluster || e.detail\r\n      console.log('点击聚合点:', cluster)\r\n\r\n      if (cluster && cluster.center) {\r\n        // 放大地图以展开聚合点\r\n        const newScale = Math.min(this.mapScale + 2, 20)\r\n        this.mapScale = newScale\r\n        this.mapCenter = {\r\n          latitude: cluster.center.latitude,\r\n          longitude: cluster.center.longitude\r\n        }\r\n\r\n        // 提示用户\r\n        uni.showToast({\r\n          title: '展开查看' + (cluster.markerIds ? cluster.markerIds.length : '') + '位演员',\r\n          icon: 'none',\r\n          duration: 1500\r\n        })\r\n      }\r\n    },\r\n\r\n    // ========== Uni-Push 2.0 实时位置更新 ==========\r\n\r\n    // 初始化推送并订阅\r\n    async initPushAndSubscribe() {\r\n      // 如果没有位置信息，不订阅\r\n      if (!this.userLocation.longitude || !this.userLocation.latitude) {\r\n        console.log('Uni-Push: 等待获取用户位置...')\r\n        return\r\n      }\r\n\r\n      try {\r\n        // 1. 获取推送客户端ID\r\n        await this.getPushClientId()\r\n\r\n        // 2. 注册推送消息监听\r\n        this.registerPushListener()\r\n\r\n        // 3. 向服务器注册订阅\r\n        await this.subscribeToServer()\r\n\r\n        console.log('Uni-Push: 初始化完成')\r\n      } catch (error) {\r\n        console.error('Uni-Push: 初始化失败', error)\r\n      }\r\n    },\r\n\r\n    // 获取推送客户端ID\r\n    getPushClientId() {\r\n      return new Promise((resolve, reject) => {\r\n        // #ifdef APP-PLUS\r\n        // App端使用 plus.push\r\n        const clientInfo = plus.push.getClientInfo()\r\n        if (clientInfo && clientInfo.clientid) {\r\n          this.pushClientId = clientInfo.clientid\r\n          this.pushConnected = true\r\n          console.log('Uni-Push: 获取到clientId (App)', this.pushClientId)\r\n          resolve(this.pushClientId)\r\n        } else {\r\n          // 监听 clientid 获取\r\n          plus.push.addEventListener('receive', (msg) => {\r\n            // 推送消息接收\r\n          }, false)\r\n          // 延迟获取\r\n          setTimeout(() => {\r\n            const info = plus.push.getClientInfo()\r\n            if (info && info.clientid) {\r\n              this.pushClientId = info.clientid\r\n              this.pushConnected = true\r\n              resolve(this.pushClientId)\r\n            } else {\r\n              reject(new Error('Failed to get push clientId'))\r\n            }\r\n          }, 1500)\r\n        }\r\n        // #endif\r\n\r\n        // #ifdef MP-WEIXIN\r\n        // 小程序端使用 websocket 模拟或 订阅消息\r\n        // 注意：微信小程序不支持真正的推送，需要使用其他方案\r\n        // 这里使用 uni-id-pages 的设备ID 作为标识\r\n        const deviceId = uni.getStorageSync('uni_deviceId') || this.generateDeviceId()\r\n        this.pushClientId = deviceId\r\n        this.pushConnected = true\r\n        console.log('Uni-Push: 小程序使用deviceId', this.pushClientId)\r\n        resolve(this.pushClientId)\r\n        // #endif\r\n\r\n        // #ifdef H5\r\n        // H5端降级处理\r\n        const deviceId = uni.getStorageSync('uni_deviceId') || this.generateDeviceId()\r\n        this.pushClientId = deviceId\r\n        this.pushConnected = true\r\n        resolve(this.pushClientId)\r\n        // #endif\r\n      })\r\n    },\r\n\r\n    // 生成设备ID\r\n    generateDeviceId() {\r\n      const deviceId = 'device_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9)\r\n      uni.setStorageSync('uni_deviceId', deviceId)\r\n      return deviceId\r\n    },\r\n\r\n    // 注册推送消息监听\r\n    registerPushListener() {\r\n      // #ifdef APP-PLUS\r\n      // App端监听推送消息\r\n      this.pushMessageHandler = (msg) => {\r\n        console.log('Uni-Push: 收到推送消息', msg)\r\n\r\n        // 解析消息内容\r\n        let payload = null\r\n        if (msg.payload) {\r\n          payload = typeof msg.payload === 'string' ? JSON.parse(msg.payload) : msg.payload\r\n        } else if (msg.content) {\r\n          try {\r\n            payload = JSON.parse(msg.content)\r\n          } catch (e) {\r\n            console.warn('Uni-Push: 消息内容解析失败')\r\n            return\r\n          }\r\n        }\r\n\r\n        if (payload) {\r\n          this.handlePushMessage(payload)\r\n        }\r\n      }\r\n\r\n      // 监听透传消息\r\n      plus.push.addEventListener('receive', this.pushMessageHandler, false)\r\n      console.log('Uni-Push: 已注册App推送监听')\r\n      // #endif\r\n\r\n      // #ifdef MP-WEIXIN\r\n      // 小程序端：使用轮询或长连接模拟（实际生产中可使用云开发的实时数据推送）\r\n      // 这里为小程序提供一个降级方案：定时拉取更新\r\n      this.startMiniProgramPolling()\r\n      // #endif\r\n    },\r\n\r\n    // 小程序降级方案：定时拉取位置更新\r\n    startMiniProgramPolling() {\r\n      // 小程序不支持真正的推送，使用 30 秒轮询作为降级方案\r\n      // 实际生产中建议使用：\r\n      // 1. 云开发的实时数据推送\r\n      // 2. 或者微信小程序的 WebSocket\r\n      this.miniProgramPollingTimer = setInterval(async () => {\r\n        if (!this.pushConnected) return\r\n        try {\r\n          // 拉取最新位置更新\r\n          const pushLocationCo = uniCloud.importObject('push-location')\r\n          // 这里需要后端提供一个拉取接口\r\n          // const res = await pushLocationCo.pullLocationUpdates({ viewport: this.currentViewport })\r\n          // if (res.code === 0 && res.data) {\r\n          //   res.data.forEach(update => this.handleLocationUpdate(update))\r\n          // }\r\n        } catch (error) {\r\n          console.error('小程序轮询位置更新失败:', error)\r\n        }\r\n      }, 30000)\r\n    },\r\n\r\n    // 向服务器注册订阅\r\n    async subscribeToServer() {\r\n      if (!this.pushClientId) {\r\n        console.warn('Uni-Push: 无pushClientId，无法订阅')\r\n        return\r\n      }\r\n\r\n      try {\r\n        const pushLocationCo = uniCloud.importObject('push-location')\r\n        const res = await pushLocationCo.subscribe({\r\n          push_clientid: this.pushClientId,\r\n          viewport: this.currentViewport,\r\n          user_location: this.userLocation,\r\n          role: 'crew',\r\n          platform: this.getPlatform()\r\n        })\r\n\r\n        if (res.code === 0) {\r\n          console.log('Uni-Push: 订阅成功')\r\n        } else {\r\n          console.error('Uni-Push: 订阅失败', res.msg)\r\n        }\r\n      } catch (error) {\r\n        console.error('Uni-Push: 订阅请求失败', error)\r\n      }\r\n    },\r\n\r\n    // 更新订阅（视口变化时调用）\r\n    async updateSubscription() {\r\n      if (!this.pushClientId || !this.pushConnected) return\r\n\r\n      try {\r\n        const pushLocationCo = uniCloud.importObject('push-location')\r\n        await pushLocationCo.setActive({\r\n          is_active: true,\r\n          viewport: this.currentViewport,\r\n          user_location: this.userLocation\r\n        })\r\n        console.log('Uni-Push: 订阅已更新')\r\n      } catch (error) {\r\n        console.error('Uni-Push: 更新订阅失败', error)\r\n      }\r\n    },\r\n\r\n    // 设置订阅为非活跃状态\r\n    async setSubscriptionInactive() {\r\n      if (!this.pushClientId) return\r\n\r\n      try {\r\n        const pushLocationCo = uniCloud.importObject('push-location')\r\n        await pushLocationCo.setActive({\r\n          is_active: false\r\n        })\r\n        console.log('Uni-Push: 已设置为非活跃')\r\n      } catch (error) {\r\n        console.error('Uni-Push: 设置非活跃失败', error)\r\n      }\r\n    },\r\n\r\n    // 取消订阅\r\n    async unsubscribePush() {\r\n      // #ifdef APP-PLUS\r\n      // 移除推送监听\r\n      if (this.pushMessageHandler) {\r\n        plus.push.removeEventListener('receive', this.pushMessageHandler)\r\n        this.pushMessageHandler = null\r\n      }\r\n      // #endif\r\n\r\n      // #ifdef MP-WEIXIN\r\n      // 停止小程序轮询\r\n      if (this.miniProgramPollingTimer) {\r\n        clearInterval(this.miniProgramPollingTimer)\r\n        this.miniProgramPollingTimer = null\r\n      }\r\n      // #endif\r\n\r\n      // 通知服务器取消订阅\r\n      if (this.pushClientId) {\r\n        try {\r\n          const pushLocationCo = uniCloud.importObject('push-location')\r\n          await pushLocationCo.unsubscribe({})\r\n        } catch (error) {\r\n          console.error('Uni-Push: 取消订阅失败', error)\r\n        }\r\n      }\r\n\r\n      this.pushConnected = false\r\n      console.log('Uni-Push: 已取消订阅')\r\n    },\r\n\r\n    // 处理推送消息\r\n    handlePushMessage(message) {\r\n      console.log('Uni-Push: 处理消息', message)\r\n\r\n      if (!message || !message.type) {\r\n        console.warn('Uni-Push: 无效消息格式')\r\n        return\r\n      }\r\n\r\n      switch (message.type) {\r\n        case 'location-update':\r\n          // 演员位置更新\r\n          this.handleLocationUpdate(message.data)\r\n          break\r\n\r\n        case 'actor-online':\r\n          // 演员上线\r\n          this.handleActorOnline(message.data)\r\n          break\r\n\r\n        case 'actor-offline':\r\n          // 演员下线\r\n          this.handleActorOffline(message.data)\r\n          break\r\n\r\n        default:\r\n          console.log('Uni-Push: 未知消息类型', message.type)\r\n      }\r\n    },\r\n\r\n    // 获取平台类型\r\n    getPlatform() {\r\n      // #ifdef APP-PLUS\r\n      return 'app'\r\n      // #endif\r\n      // #ifdef MP-WEIXIN\r\n      return 'mp-weixin'\r\n      // #endif\r\n      // #ifdef H5\r\n      return 'h5'\r\n      // #endif\r\n      return 'unknown'\r\n    },\r\n\r\n    // 处理位置更新事件 - 增量更新 + 平滑移动\r\n    handleLocationUpdate(data) {\r\n      // data格式: { actor_id: 'xxx', latitude: 29.5630, longitude: 106.4650, timestamp: 1704700000000 }\r\n      // 或批量: [{ actor_id, latitude, longitude, timestamp }, ...]\r\n\r\n      const updates = Array.isArray(data) ? data : [data]\r\n\r\n      updates.forEach(update => {\r\n        const { actor_id, latitude, longitude } = update\r\n\r\n        if (!actor_id || latitude == null || longitude == null) {\r\n          return\r\n        }\r\n\r\n        // 1. 查找并更新 actorMarkerData 中的数据\r\n        const markerIndex = this.actorMarkerData.findIndex(m => m.id === actor_id)\r\n        if (markerIndex !== -1) {\r\n          const oldLat = this.actorMarkerData[markerIndex].latitude\r\n          const oldLng = this.actorMarkerData[markerIndex].longitude\r\n\r\n          // 更新数据\r\n          this.actorMarkerData[markerIndex].latitude = latitude\r\n          this.actorMarkerData[markerIndex].longitude = longitude\r\n\r\n          // 2. 使用 translateMarker 实现平滑移动\r\n          this.smoothMoveMarker(actor_id, oldLat, oldLng, latitude, longitude)\r\n        }\r\n\r\n        // 3. 同步更新 actorList 中的数据\r\n        const actorIndex = this.actorList.findIndex(a => a.id === actor_id || a._id === actor_id)\r\n        if (actorIndex !== -1) {\r\n          this.actorList[actorIndex].latitude = latitude\r\n          this.actorList[actorIndex].longitude = longitude\r\n        }\r\n\r\n        // 4. 更新 actorMarkers 数组中的对应项\r\n        const markersIndex = this.actorMarkers.findIndex(m => m.id === actor_id)\r\n        if (markersIndex !== -1) {\r\n          this.$set(this.actorMarkers[markersIndex], 'latitude', latitude)\r\n          this.$set(this.actorMarkers[markersIndex], 'longitude', longitude)\r\n        }\r\n      })\r\n\r\n      console.log('Uni-Push: 处理位置更新', updates.length, '条')\r\n    },\r\n\r\n    // 平滑移动Marker\r\n    smoothMoveMarker(markerId, fromLat, fromLng, toLat, toLng) {\r\n      if (!this.mapContext) {\r\n        console.warn('smoothMoveMarker: mapContext未初始化')\r\n        return\r\n      }\r\n\r\n      // 如果位置变化很小，不执行动画\r\n      const latDiff = Math.abs(toLat - fromLat)\r\n      const lngDiff = Math.abs(toLng - fromLng)\r\n      if (latDiff < 0.00001 && lngDiff < 0.00001) {\r\n        return\r\n      }\r\n\r\n      // 使用 translateMarker 实现平滑移动动画\r\n      this.mapContext.translateMarker({\r\n        markerId: markerId,\r\n        destination: {\r\n          latitude: toLat,\r\n          longitude: toLng\r\n        },\r\n        duration: this.markerAnimationDuration,\r\n        autoRotate: false,\r\n        success: () => {\r\n          // 动画完成\r\n        },\r\n        fail: (err) => {\r\n          // translateMarker 失败时，直接更新位置\r\n          console.warn('translateMarker失败，直接更新位置:', err)\r\n          this.updateActorMarkers()\r\n        }\r\n      })\r\n    },\r\n\r\n    // 处理演员上线事件\r\n    handleActorOnline(data) {\r\n      const { actor_id, latitude, longitude, actor_info } = data\r\n\r\n      // 检查是否已存在\r\n      const existingIndex = this.actorMarkerData.findIndex(m => m.id === actor_id)\r\n\r\n      if (existingIndex !== -1) {\r\n        // 已存在，更新状态\r\n        this.actorMarkerData[existingIndex].isOnline = true\r\n        this.actorMarkerData[existingIndex].latitude = latitude\r\n        this.actorMarkerData[existingIndex].longitude = longitude\r\n      } else if (actor_info) {\r\n        // 不存在且有演员信息，添加新标记\r\n        this.actorMarkerData.push({\r\n          id: actor_id,\r\n          latitude: latitude,\r\n          longitude: longitude,\r\n          avatar: actor_info.avatar || this.defaultAvatarPath,\r\n          isOnline: true,\r\n          nickname: actor_info.nickname || '--',\r\n          height: actor_info.height || 170\r\n        })\r\n      }\r\n\r\n      // 更新地图标记\r\n      this.updateActorMarkers()\r\n      console.log('Uni-Push: 演员上线', actor_id)\r\n    },\r\n\r\n    // 处理演员下线事件\r\n    handleActorOffline(data) {\r\n      const { actor_id } = data\r\n\r\n      // 更新在线状态\r\n      const markerIndex = this.actorMarkerData.findIndex(m => m.id === actor_id)\r\n      if (markerIndex !== -1) {\r\n        this.actorMarkerData[markerIndex].isOnline = false\r\n      }\r\n\r\n      const actorIndex = this.actorList.findIndex(a => a.id === actor_id || a._id === actor_id)\r\n      if (actorIndex !== -1) {\r\n        this.actorList[actorIndex].isOnline = false\r\n      }\r\n\r\n      // 更新地图标记（更新callout颜色等）\r\n      this.updateActorMarkers()\r\n      console.log('Uni-Push: 演员下线', actor_id)\r\n    },\r\n\r\n    showActorDetail(actor) {\r\n      this.selectedActor = actor\r\n      this.$refs.actorDetailPopup.open()\r\n    },\r\n\r\n    closeActorDetail() {\r\n      this.$refs.actorDetailPopup.close()\r\n    },\r\n\r\n    inviteActor() {\r\n      if (!this.requireLogin('邀请演员')) return\r\n      uni.showToast({\r\n        title: '邀请功能开发中',\r\n        icon: 'none'\r\n      })\r\n    },\r\n\r\n    // ========== 抽屉相关 ==========\r\n    onDrawerTouchStart(e) {\r\n      this.touchStartY = e.touches[0].clientY\r\n      this.drawerStartHeight = this.drawerHeight\r\n      this.isDragging = true\r\n    },\r\n\r\n    onDrawerTouchMove(e) {\r\n      if (!this.isDragging) return\r\n\r\n      const currentY = e.touches[0].clientY\r\n      const deltaY = this.touchStartY - currentY\r\n      const deltaRpx = deltaY * 2\r\n\r\n      let newHeight = this.drawerStartHeight + deltaRpx\r\n\r\n      if (newHeight < this.drawerMinHeight) {\r\n        newHeight = this.drawerMinHeight\r\n      }\r\n      if (newHeight > this.drawerMaxHeight) {\r\n        newHeight = this.drawerMaxHeight\r\n      }\r\n\r\n      this.drawerHeight = newHeight\r\n    },\r\n\r\n    onDrawerTouchEnd(e) {\r\n      this.isDragging = false\r\n      this.touchStartY = 0\r\n      this.drawerStartHeight = 0\r\n    },\r\n\r\n    // ========== 搜索 ==========\r\n    onSearchInput() {\r\n      // 清除之前的防抖定时器\r\n      if (this.searchTimer) {\r\n        clearTimeout(this.searchTimer)\r\n      }\r\n\r\n      const keyword = this.searchKeyword.trim()\r\n      if (!keyword) {\r\n        this.searchResults = []\r\n        this.searchLoading = false\r\n        return\r\n      }\r\n\r\n      // 显示loading状态\r\n      this.searchLoading = true\r\n\r\n      // 防抖：500ms后调用后端搜索接口\r\n      this.searchTimer = setTimeout(() => {\r\n        this.searchActorsFromApi(keyword)\r\n      }, 500)\r\n    },\r\n\r\n    // 调用后端搜索接口\r\n    async searchActorsFromApi(keyword) {\r\n      if (!keyword) {\r\n        this.searchResults = []\r\n        this.searchLoading = false\r\n        return\r\n      }\r\n\r\n      try {\r\n        const orderCo = uniCloud.importObject('order-co')\r\n\r\n        // 构建搜索参数\r\n        const params = {\r\n          keyword: keyword,\r\n          // 传递用户位置用于计算距离和排序\r\n          userLongitude: this.userLocation.longitude,\r\n          userLatitude: this.userLocation.latitude,\r\n          // 可选：限制搜索结果数量\r\n          limit: 50\r\n        }\r\n\r\n        console.log('搜索演员, 关键字:', keyword, '参数:', params)\r\n\r\n        const res = await orderCo.searchActors(params)\r\n\r\n        if (res.code === 0 && res.data) {\r\n          // 处理搜索结果数据\r\n          const skillLabelMap = {\r\n            'driving': '开车',\r\n            'dancing': '跳舞',\r\n            'singing': '唱歌',\r\n            'martial_arts': '武术',\r\n            'swimming': '游泳',\r\n            'riding': '骑马',\r\n            'instrument': '乐器',\r\n            'language': '外语'\r\n          }\r\n\r\n          const bodyTypeMap = {\r\n            'slim': '偏瘦',\r\n            'standard': '标准',\r\n            'athletic': '健壮',\r\n            'plump': '偏胖'\r\n          }\r\n\r\n          this.searchResults = res.data.map((actor, index) => {\r\n            const avatarFile = actor.avatar_file\r\n            const avatarUrl = (avatarFile && avatarFile.url) || actor.avatar || this.defaultAvatarPath\r\n\r\n            // 确定演员位置\r\n            const isOnline = actor.online_status === 1\r\n            let actorLat = null\r\n            let actorLng = null\r\n\r\n            if (isOnline && actor.current_location) {\r\n              actorLat = actor.current_location.coordinates[1]\r\n              actorLng = actor.current_location.coordinates[0]\r\n            } else if (actor.last_login_location) {\r\n              actorLat = actor.last_login_location.coordinates[1]\r\n              actorLng = actor.last_login_location.coordinates[0]\r\n            } else if (actor.location) {\r\n              actorLat = actor.location.coordinates[1]\r\n              actorLng = actor.location.coordinates[0]\r\n            }\r\n\r\n            return {\r\n              id: actor._id || index + 1,\r\n              _id: actor._id,\r\n              nickname: actor.nickname || '--',\r\n              avatar: avatarUrl,\r\n              height: actor.height || 170,\r\n              gender: actor.gender || 0,\r\n              bodyType: bodyTypeMap[actor.body_type] || actor.body_type || '--',\r\n              credit_score: actor.credit_score_actor || 100,\r\n              distance: actor.distance_km ? parseFloat(actor.distance_km).toFixed(1) : '-',\r\n              skills: (actor.skills || []).map(s => skillLabelMap[s] || s),\r\n              latitude: actorLat,\r\n              longitude: actorLng,\r\n              videoCard: actor.video_card || actor.video_card_url || '',\r\n              isOnline: isOnline,\r\n              lastActiveTime: actor.last_active_time || null\r\n            }\r\n          })\r\n\r\n          console.log('搜索结果:', this.searchResults.length, '条')\r\n        } else {\r\n          this.searchResults = []\r\n          if (res.code !== 0) {\r\n            console.error('搜索失败:', res.message || res.msg)\r\n          }\r\n        }\r\n      } catch (error) {\r\n        console.error('搜索演员失败:', error)\r\n        this.searchResults = []\r\n        uni.showToast({\r\n          title: '搜索失败，请重试',\r\n          icon: 'none'\r\n        })\r\n      } finally {\r\n        this.searchLoading = false\r\n      }\r\n    },\r\n\r\n    // 点击搜索结果项 - 定位到地图并显示详情\r\n    onSearchResultTap(actor) {\r\n      if (!actor) return\r\n\r\n      // 1. 收起抽屉以便查看地图\r\n      this.drawerHeight = this.drawerMinHeight\r\n\r\n      // 2. 移动地图中心到该演员位置\r\n      if (actor.latitude && actor.longitude) {\r\n        // 放大地图比例\r\n        this.mapScale = 17\r\n\r\n        // 使用 $set 确保响应式更新地图中心点\r\n        this.$set(this.mapCenter, 'latitude', actor.latitude)\r\n        this.$set(this.mapCenter, 'longitude', actor.longitude)\r\n\r\n        console.log('地图聚焦到演员位置:', actor.nickname, actor.latitude, actor.longitude)\r\n\r\n        // 如果有 mapContext，尝试使用 includePoints 确保视图包含该点\r\n        if (this.mapContext) {\r\n          this.mapContext.includePoints({\r\n            points: [{\r\n              latitude: actor.latitude,\r\n              longitude: actor.longitude\r\n            }],\r\n            padding: [50, 50, 50, 50],\r\n            success: () => {\r\n              console.log('includePoints 成功')\r\n            },\r\n            fail: (err) => {\r\n              console.warn('includePoints 失败:', err)\r\n            }\r\n          })\r\n        }\r\n      }\r\n\r\n      // 3. 显示演员详情弹窗\r\n      // 延迟显示弹窗，确保地图移动完成\r\n      setTimeout(() => {\r\n        this.showActorDetail(actor)\r\n      }, 300)\r\n    },\r\n\r\n    clearSearch() {\r\n      this.searchKeyword = ''\r\n      this.searchResults = []\r\n      this.searchLoading = false\r\n    },\r\n\r\n    // ========== 登录检查 ==========\r\n    checkLoginStatus() {\r\n      try {\r\n        const token = uni.getStorageSync('uni_id_token')\r\n        const tokenExpired = uni.getStorageSync('uni_id_token_expired')\r\n        return token && tokenExpired && tokenExpired > Date.now()\r\n      } catch (error) {\r\n        return false\r\n      }\r\n    },\r\n\r\n    requireLogin(actionName = '此操作') {\r\n      if (this.isLoggedIn) return true\r\n\r\n      uni.showModal({\r\n        title: '需要登录',\r\n        content: `${actionName}需要登录后才能使用，是否现在登录？`,\r\n        confirmText: '去登录',\r\n        success: (res) => {\r\n          if (res.confirm) {\r\n            uni.setStorageSync('selected_role', 'crew')\r\n            uni.navigateTo({\r\n              url: '/uni_modules/uni-id-pages/pages/login/login-withpwd'\r\n            })\r\n          }\r\n        }\r\n      })\r\n      return false\r\n    },\r\n\r\n    async loadUserInfo() {\r\n      try {\r\n        const res = await uniCloud.getCurrentUserInfo()\r\n        this.userInfo = res\r\n      } catch (error) {\r\n        console.error('加载用户信息失败:', error)\r\n      }\r\n    },\r\n\r\n    async loadStats() {\r\n      try {\r\n        const token = uni.getStorageSync('uni_id_token')\r\n        if (!token) return\r\n\r\n        const userCo = uniCloud.importObject('user-co')\r\n        const res = await userCo.getStats()\r\n\r\n        if (res.code === 0 && res.data) {\r\n          this.stats = {\r\n            pending: res.data.pending || 0,\r\n            ongoing: res.data.in_progress || 0,\r\n            completed: res.data.completed || 0\r\n          }\r\n          if (res.data.credit_score) {\r\n            this.userInfo.credit_score_crew = res.data.credit_score\r\n          }\r\n        }\r\n      } catch (error) {\r\n        console.error('加载统计失败:', error)\r\n      }\r\n    },\r\n\r\n    async loadRecentOrders() {\r\n      try {\r\n        const token = uni.getStorageSync('uni_id_token')\r\n        if (!token) return\r\n\r\n        const orderCo = uniCloud.importObject('order-co')\r\n        const res = await orderCo.getMyOrders({\r\n          page: 1,\r\n          pageSize: 5\r\n        })\r\n\r\n        if (res.code === 0) {\r\n          this.orderList = res.data.list\r\n        } else if (res.code === 401) {\r\n          uni.reLaunch({\r\n            url: '/pages/index/index'\r\n          })\r\n        }\r\n      } catch (error) {\r\n        console.error('加载订单失败:', error)\r\n        if (error.message && error.message.includes('登录')) {\r\n          uni.reLaunch({\r\n            url: '/pages/index/index'\r\n          })\r\n        }\r\n      }\r\n    },\r\n\r\n    goToPostOrder() {\r\n      if (!this.requireLogin('发布需求')) return\r\n      uni.navigateTo({\r\n        url: '/pages/crew/post_order'\r\n      })\r\n    },\r\n\r\n    goToOrderList() {\r\n      if (!this.requireLogin('查看订单')) return\r\n      uni.navigateTo({\r\n        url: '/pages/crew/order_list'\r\n      })\r\n    },\r\n\r\n    goToOrderDetail(orderId) {\r\n      if (!this.requireLogin('查看订单详情')) return\r\n      uni.navigateTo({\r\n        url: `/pages/crew/order_detail?id=${orderId}`\r\n      })\r\n    },\r\n\r\n    goToProfile() {\r\n      if (!this.requireLogin('查看个人中心')) return\r\n      uni.navigateTo({\r\n        url: '/pages/crew/profile'\r\n      })\r\n    },\r\n\r\n    // ========== 工具方法 ==========\r\n    getCreditClass(score) {\r\n      if (score >= 130) return 'credit-gold'\r\n      if (score >= 110) return 'credit-silver'\r\n      return 'credit-normal'\r\n    },\r\n\r\n    getCreditLevel(score) {\r\n      if (score >= 130) return '金牌剧组'\r\n      if (score >= 110) return '优质剧组'\r\n      if (score >= 90) return '良好'\r\n      return '普通'\r\n    },\r\n\r\n    getStatusText(status) {\r\n      const textMap = {\r\n        0: '待接单',\r\n        1: '进行中',\r\n        2: '待支付',\r\n        3: '已完成',\r\n        4: '已取消'\r\n      }\r\n      return textMap[status] || '未知'\r\n    },\r\n\r\n    formatTime(timestamp) {\r\n      const date = new Date(timestamp)\r\n      const now = new Date()\r\n      const diff = now - date\r\n\r\n      if (diff < 60000) return '刚刚'\r\n      if (diff < 3600000) return `${Math.floor(diff / 60000)}分钟前`\r\n      if (diff < 86400000) return `${Math.floor(diff / 3600000)}小时前`\r\n      if (diff < 604800000) return `${Math.floor(diff / 86400000)}天前`\r\n\r\n      return `${date.getMonth() + 1}-${date.getDate()}`\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n@import '@/common/theme.scss';\r\n\r\n.crew-home-map {\r\n  width: 100%;\r\n  height: 100vh;\r\n  position: relative;\r\n  background-color: $bg-primary;\r\n}\r\n\r\n// ========== 地图层 ==========\r\n.map-layer {\r\n  width: 100%;\r\n  height: 100%;\r\n}\r\n\r\n// ========== 我的图标 ==========\r\n.my-profile-icon-crew {\r\n  position: absolute;\r\n  left: 32rpx;\r\n  top: 60rpx;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: center;\r\n  width: 100rpx;\r\n  height: 100rpx;\r\n  background-color: rgba(255, 255, 255, 0.95);\r\n  border-radius: 20rpx;\r\n  box-shadow: 0 8rpx 16rpx rgba(0, 0, 0, 0.15);\r\n}\r\n\r\n.my-icon-circle {\r\n  width: 48rpx;\r\n  height: 48rpx;\r\n  position: relative;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n}\r\n\r\n.my-icon-head {\r\n  width: 20rpx;\r\n  height: 20rpx;\r\n  background-color: #333;\r\n  border-radius: 50%;\r\n}\r\n\r\n.my-icon-body {\r\n  width: 32rpx;\r\n  height: 18rpx;\r\n  background-color: #333;\r\n  border-radius: 16rpx 16rpx 0 0;\r\n  margin-top: 4rpx;\r\n}\r\n\r\n.my-text-crew {\r\n  font-size: 20rpx;\r\n  color: #333;\r\n  font-weight: 600;\r\n  margin-top: 4rpx;\r\n}\r\n\r\n// ========== 底部抽屉 ==========\r\n.drawer-container {\r\n  position: fixed;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  background-color: $bg-secondary;\r\n  border-radius: $border-radius-lg $border-radius-lg 0 0;\r\n  z-index: $z-index-drawer;\r\n  box-shadow: 0 -4rpx 16rpx rgba(0, 0, 0, 0.3);\r\n  will-change: height;\r\n}\r\n\r\n.drawer-handle-area {\r\n  padding: $spacing-sm 0;\r\n  @include flex-center;\r\n}\r\n\r\n.drawer-handle {\r\n  width: 80rpx;\r\n  height: 8rpx;\r\n  background-color: $gray-3;\r\n  border-radius: 4rpx;\r\n}\r\n\r\n.drawer-content {\r\n  padding: 0 $spacing-base $spacing-base;\r\n  box-sizing: border-box;\r\n}\r\n\r\n// ========== 搜索栏 ==========\r\n.search-bar {\r\n  display: flex;\r\n  align-items: center;\r\n  background-color: $bg-tertiary;\r\n  border-radius: $border-radius-base;\r\n  padding: $spacing-sm $spacing-base;\r\n  margin-bottom: $spacing-base;\r\n  gap: $spacing-sm;\r\n}\r\n\r\n.search-input {\r\n  flex: 1;\r\n  color: $text-primary;\r\n  font-size: $font-size-base;\r\n}\r\n\r\n.search-placeholder {\r\n  color: $text-hint;\r\n}\r\n\r\n.search-clear {\r\n  @include flex-center;\r\n}\r\n\r\n// ========== 搜索结果 ==========\r\n.search-results {\r\n  margin-bottom: $spacing-base;\r\n}\r\n\r\n.result-count {\r\n  font-size: $font-size-sm;\r\n  color: $text-secondary;\r\n}\r\n\r\n.search-list {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: $spacing-sm;\r\n}\r\n\r\n.search-item {\r\n  display: flex;\r\n  align-items: center;\r\n  background-color: $bg-tertiary;\r\n  border-radius: $border-radius-base;\r\n  padding: $spacing-base;\r\n  gap: $spacing-base;\r\n\r\n  &:active {\r\n    opacity: 0.8;\r\n  }\r\n}\r\n\r\n.actor-avatar {\r\n  width: 80rpx;\r\n  height: 80rpx;\r\n  border-radius: $border-radius-circle;\r\n  background-color: $gray-4;\r\n}\r\n\r\n.actor-info {\r\n  flex: 1;\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 8rpx;\r\n}\r\n\r\n.actor-name {\r\n  font-size: $font-size-lg;\r\n  font-weight: $font-weight-medium;\r\n  color: $text-primary;\r\n}\r\n\r\n.actor-meta {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 8rpx;\r\n  font-size: $font-size-sm;\r\n  color: $text-secondary;\r\n}\r\n\r\n.meta-item {\r\n  font-family: $font-family-monospace;\r\n}\r\n\r\n.meta-divider {\r\n  color: $gray-3;\r\n}\r\n\r\n.credit-badge {\r\n  padding: 8rpx 16rpx;\r\n  border-radius: $border-radius-sm;\r\n  font-size: $font-size-sm;\r\n  font-weight: $font-weight-bold;\r\n\r\n  &.credit-gold {\r\n    @include credit-badge('gold');\r\n  }\r\n\r\n  &.credit-silver {\r\n    @include credit-badge('silver');\r\n  }\r\n\r\n  &.credit-normal {\r\n    @include credit-badge('normal');\r\n  }\r\n}\r\n\r\n// ========== 搜索Loading ==========\r\n.search-loading {\r\n  padding: $spacing-lg 0;\r\n  @include flex-center;\r\n  @include flex-column;\r\n  gap: $spacing-sm;\r\n\r\n  .loading-spinner {\r\n    width: 40rpx;\r\n    height: 40rpx;\r\n    border: 4rpx solid $gray-3;\r\n    border-top-color: $primary-color;\r\n    border-radius: 50%;\r\n    animation: spin 0.8s linear infinite;\r\n  }\r\n\r\n  .loading-text {\r\n    font-size: $font-size-sm;\r\n    color: $text-secondary;\r\n  }\r\n}\r\n\r\n@keyframes spin {\r\n  from { transform: rotate(0deg); }\r\n  to { transform: rotate(360deg); }\r\n}\r\n\r\n.empty-search {\r\n  padding: $spacing-lg 0;\r\n  text-align: center;\r\n\r\n  .empty-text {\r\n    font-size: $font-size-base;\r\n    color: $text-secondary;\r\n  }\r\n}\r\n\r\n// ========== 主内容区 ==========\r\n.main-content {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: $spacing-base;\r\n}\r\n\r\n// ========== 最近订单 ==========\r\n.recent-orders-compact {\r\n  padding: $spacing-base;\r\n  background-color: $bg-tertiary;\r\n  border-radius: $border-radius-base;\r\n}\r\n\r\n.section-header-compact {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  margin-bottom: $spacing-base;\r\n\r\n  .section-title-text {\r\n    font-size: $font-size-lg;\r\n    font-weight: $font-weight-bold;\r\n    color: $text-primary;\r\n  }\r\n\r\n  .more-link {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 4rpx;\r\n    font-size: $font-size-sm;\r\n    color: $primary-color;\r\n  }\r\n}\r\n\r\n.order-list-compact {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: $spacing-sm;\r\n}\r\n\r\n.order-item-compact {\r\n  padding: $spacing-sm;\r\n  background-color: $bg-primary;\r\n  border-radius: $border-radius-sm;\r\n\r\n  &:active {\r\n    opacity: 0.8;\r\n  }\r\n}\r\n\r\n.order-header-compact {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  margin-bottom: 8rpx;\r\n\r\n  .order-status-compact {\r\n    padding: 4rpx 12rpx;\r\n    border-radius: 8rpx;\r\n    font-size: $font-size-xs;\r\n    font-weight: $font-weight-medium;\r\n\r\n    &.status-pending {\r\n      @include status-tag($warning-color);\r\n    }\r\n\r\n    &.status-ongoing {\r\n      @include status-tag($secondary-color);\r\n    }\r\n\r\n    &.status-completed {\r\n      @include status-tag($success-color);\r\n    }\r\n  }\r\n\r\n  .order-time-compact {\r\n    font-size: $font-size-xs;\r\n    color: $text-hint;\r\n  }\r\n}\r\n\r\n.order-content-compact {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n\r\n  .order-location {\r\n    flex: 1;\r\n    font-size: $font-size-sm;\r\n    color: $text-secondary;\r\n    @include text-ellipsis;\r\n  }\r\n\r\n  .order-price {\r\n    font-size: $font-size-lg;\r\n    font-weight: $font-weight-bold;\r\n    color: $primary-color;\r\n    font-family: $font-family-monospace;\r\n\r\n    &::before {\r\n      content: '\\00A5';\r\n    }\r\n  }\r\n}\r\n\r\n.empty-orders-compact {\r\n  padding: $spacing-lg 0;\r\n  text-align: center;\r\n\r\n  .empty-text-compact {\r\n    font-size: $font-size-sm;\r\n    color: $text-secondary;\r\n  }\r\n}\r\n\r\n// ========== 信用分 ==========\r\n.credit-section-compact {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  padding: $spacing-base;\r\n  background: linear-gradient(135deg, rgba($primary-color, 0.2) 0%, rgba($secondary-color, 0.2) 100%);\r\n  border-radius: $border-radius-base;\r\n}\r\n\r\n.credit-info {\r\n  display: flex;\r\n  align-items: baseline;\r\n  gap: $spacing-sm;\r\n\r\n  .credit-title-compact {\r\n    font-size: $font-size-sm;\r\n    color: $text-secondary;\r\n  }\r\n\r\n  .credit-score-compact {\r\n    display: flex;\r\n    align-items: baseline;\r\n    gap: 4rpx;\r\n\r\n    .score-value {\r\n      font-size: 40rpx;\r\n      font-weight: $font-weight-bold;\r\n      color: $primary-color;\r\n      font-family: $font-family-monospace;\r\n    }\r\n\r\n    .score-max {\r\n      font-size: $font-size-sm;\r\n      color: $text-secondary;\r\n    }\r\n  }\r\n}\r\n\r\n.credit-level-badge {\r\n  padding: 8rpx 20rpx;\r\n  border-radius: $border-radius-sm;\r\n  font-size: $font-size-sm;\r\n  font-weight: $font-weight-bold;\r\n\r\n  &.level-gold {\r\n    @include credit-badge('gold');\r\n  }\r\n\r\n  &.level-silver {\r\n    @include credit-badge('silver');\r\n  }\r\n\r\n  &.level-normal {\r\n    @include credit-badge('normal');\r\n  }\r\n}\r\n\r\n// ========== FAB 悬浮按钮 ==========\r\n.fab {\r\n  position: fixed;\r\n  right: 32rpx;\r\n  bottom: 120rpx;\r\n  width: 112rpx;\r\n  height: 112rpx;\r\n  z-index: 999;\r\n\r\n  .fab-bg {\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    width: 112rpx;\r\n    height: 112rpx;\r\n    background-color: #FFD700;\r\n    border-radius: 56rpx;\r\n  }\r\n\r\n  .fab-icon {\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    width: 112rpx;\r\n    height: 112rpx;\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n    font-size: 72rpx;\r\n    font-weight: 200;\r\n    color: #000000;\r\n    line-height: 112rpx;\r\n    text-align: center;\r\n  }\r\n}\r\n\r\n// ========== 演员详情弹窗 ==========\r\n.actor-detail-popup {\r\n  background-color: $bg-secondary;\r\n  border-radius: $border-radius-lg $border-radius-lg 0 0;\r\n  max-height: 90vh;\r\n  overflow: hidden;\r\n}\r\n\r\n.popup-header {\r\n  position: relative;\r\n  padding: $spacing-lg;\r\n  background: linear-gradient(135deg, $primary-color 0%, #FFED4E 100%);\r\n  text-align: center;\r\n\r\n  .popup-title {\r\n    font-size: $font-size-xl;\r\n    font-weight: $font-weight-bold;\r\n    color: $black;\r\n  }\r\n\r\n  .popup-close {\r\n    position: absolute;\r\n    right: $spacing-lg;\r\n    top: $spacing-lg;\r\n  }\r\n}\r\n\r\n.actor-detail-content {\r\n  padding: $spacing-lg;\r\n}\r\n\r\n.video-card-preview {\r\n  width: 100%;\r\n  height: 400rpx;\r\n  background-color: $bg-tertiary;\r\n  border-radius: $border-radius-base;\r\n  margin-bottom: $spacing-lg;\r\n  overflow: hidden;\r\n\r\n  .video-player {\r\n    width: 100%;\r\n    height: 100%;\r\n  }\r\n\r\n  .video-placeholder {\r\n    width: 100%;\r\n    height: 100%;\r\n    @include flex-center;\r\n    @include flex-column;\r\n    gap: $spacing-base;\r\n\r\n    .placeholder-text {\r\n      font-size: $font-size-base;\r\n      color: $text-secondary;\r\n    }\r\n  }\r\n}\r\n\r\n.detail-info-grid {\r\n  display: grid;\r\n  grid-template-columns: 1fr 1fr;\r\n  gap: $spacing-base;\r\n  margin-bottom: $spacing-lg;\r\n}\r\n\r\n.info-item {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 8rpx;\r\n\r\n  .info-label {\r\n    font-size: $font-size-sm;\r\n    color: $text-secondary;\r\n  }\r\n\r\n  .info-value {\r\n    font-size: $font-size-lg;\r\n    font-weight: $font-weight-medium;\r\n    color: $text-primary;\r\n  }\r\n}\r\n\r\n.detail-skills {\r\n  margin-bottom: $spacing-lg;\r\n\r\n  .skills-label {\r\n    display: block;\r\n    font-size: $font-size-sm;\r\n    color: $text-secondary;\r\n    margin-bottom: $spacing-sm;\r\n  }\r\n\r\n  .skills-list {\r\n    display: flex;\r\n    flex-wrap: wrap;\r\n    gap: $spacing-sm;\r\n  }\r\n\r\n  .skill-tag-large {\r\n    padding: 8rpx 20rpx;\r\n    background-color: rgba($primary-color, 0.15);\r\n    border: 1rpx solid $primary-color;\r\n    border-radius: $border-radius-base;\r\n    color: $primary-color;\r\n    font-size: $font-size-base;\r\n  }\r\n}\r\n\r\n.btn-invite {\r\n  @include button-primary;\r\n  width: 100%;\r\n  margin-top: $spacing-base;\r\n}\r\n</style>\r\n","import mod from \"-!../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=style&index=0&id=0e9da1dd&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=style&index=0&id=0e9da1dd&lang=scss&scoped=true&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1768489822166\n      var cssReload = require(\"D:/HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"/\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}