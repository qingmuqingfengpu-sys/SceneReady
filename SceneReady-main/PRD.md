# 艺拍即合 - 产品需求文档 (PRD v1.2)

## 1. 项目背景与产品定位

- **核心定义**: 一款基于 LBS（地理位置服务）和大数据匹配的短剧行业用工工具
- **核心目的**: "短剧界的滴滴"——解决剧组急需用人、结算混乱痛点，同时解决大学生兼职安全与保障问题
- **价值主张**: 快（2h到岗）、准（标签筛选）、省（流程优化）、安（轨迹追踪）

## 2. 用户角色与业务流程

### 2.1 需求方（剧组/统筹）
发布需求 -> 监控位置 -> 确认完工 -> 支付结算

### 2.2 供给方（演员/学生）
接收派单 -> 抢单 -> 行程分享 -> 打卡上工 -> 收款

### 2.3 核心闭环
发单 -> 匹配推送 -> 抢单 -> 履约监控（分场景） -> 现场作业 -> 结算

## 3. 功能模块详解

### 3.1 登录与注册模块

**身份分流**:
- **剧组**: 需进行企业或项目认证
- **演员**: 需实名认证 + 学生认证（针对西南大学试点增加学信网接口）

### 3.2 LBS 任务大厅

#### 剧组端（发单）

1. **基础信息**: 集合地点、时间、需要人数
2. **精准筛选**: 性别、身高范围、体型、特长（开车/跳舞等）
3. **待遇福利标签**:
   - 功能: 勾选项（如"包盒饭"、"包来回车费"、"提供住宿"、"有奶茶/下午茶"）
   - 作用: 作为"优质订单"权重因子，高福利订单优先推送给高信用/高质量演员
4. **费用/定价设置**:
   - MVP 阶段策略: 剧组自主定价（如填写"100元/天"）
   - 未来规划 (VIP): 基于数据积累推出"行业指导价"服务

#### 演员端（接单）

- **展示**: 地图/卡片显示距离、角色要求、高亮福利标签、剧组出价

### 3.3 行程与履约系统

区分"即时单"与"预约单":

#### 模式 A: 即时单 (距离集合时间 < 2小时)
- **追踪逻辑**: 演员接单后，立即开启 LBS 实时定位分享
- **剧组端**: 实时在地图上看到演员移动轨迹

#### 模式 B: 预约单 (距离集合时间 > 2小时)
- **第一阶段（接单后 - 出发前）**: 不开启实时定位，保护隐私，省电。状态显示"待履约"
- **第二阶段（触发提醒）**: 系统根据路程智能计算，在集合时间前推送强提醒："您该出发了"
- **第三阶段（主动出发）**: 演员点击 APP 内"我已出发"按钮，开启追踪
- **异常处理**: 若超过"最晚出发时间"未点击，触发电话/短信报警，通知剧组可能迟到

#### 通用逻辑
- **电子围栏打卡**: 无论哪种模式，到达现场 100 米内方可点击"上工"

### 3.4 结算与钱包系统

- **自动结算**: 依据打卡生成的工时单或一口价结算
- **资金记录**: 支持查看收入明细

## 4. 个人中心与双向信用体系

引入"双向匹配权重算法"，激励高分用户

### 4.1 演员信用分 (Actor Score)

**构成**: 履约率（不迟到/不跳单）、剧组评价、违规记录

**高分权益**:
- **优先权**: Top 20% 演员比普通演员提前 3-5 分钟收到推送
- **优质单匹配**: 优先匹配"高待遇/高福利/高客单价"订单

### 4.2 剧组信用分 (Crew Score)

**构成**: 支付及时性、如实履约、演员评价（态度、福利兑现情况）

**高分权益**:
- **优选派单**: 发单后系统优先推送给"王牌演员"
- **标记展示**: 在演员端显示"金牌剧组"徽章

### 4.3 匹配逻辑总结

- **Best Match**: 【高薪/高福利剧组】<->【高信用/高质量演员】（极速撮合）
- **Low Match**: 【低预算/低分剧组】<->【新人/低分演员】（兜底匹配）

## 5. 技术执行关键点

### 数据库设计

- `orders` 表: 包含 `welfare_tags` (JSON: ["meal", "taxi"]), `custom_price` (Decimal), `price_unit`
- `uni-id-users` 表: 扩展 `credit_score_actor`, `credit_score_crew`

### LBS 逻辑

- **定时任务**: 开发延时队列，用于预约单在 T-Time 触发提醒
- **长连接开关**: 开发"出发按钮"接口，作为 WebSocket 开启的触发器

### 匹配算法

- 废弃单纯 Distance < 5km 逻辑
- **新公式**: `Score(Actor) * Weight + Distance * Weight`，并加入"优先推送时间差"机制

## 6. MVP 下一步计划

1. **UI 调整**: 发单页增加"待遇多选框"和"价格输入框"
2. **交互设计**: 绘制预约单"待出发 -> 点击出发 -> 开启轨迹"流程图
3. **调研**: 收集常用剧组"福利黑话"预设进标签库

---

## 实现状态

| 功能模块 | 状态 | 说明 |
|----------|------|------|
| 登录注册 | 已完成 | 使用 uni-id-pages |
| 剧组端发单 | 已完成 | 支持福利标签、定价 |
| 演员端抢单 | 已完成 | 含事务处理 |
| 即时单/预约单 | 已完成 | 自动判断类型 |
| 履约追踪 | 已完成 | 电子围栏打卡 |
| 双向评价 | 已完成 | 自动调整信用分 |
| 社区系统 | 待开发 | 红黑榜功能 |
| 支付结算 | 待开发 | 需集成微信支付 |
| 推送通知 | 待开发 | 需集成 uni-push |
