# 《艺拍即合》产品需求文档 (优化版 v1.2)

## 1. 项目背景与产品定位
* [cite_start]**核心定义**：一款基于 LBS（地理位置服务）和大数据匹配的短剧行业用工工具 [cite: 3]。
* [cite_start]**核心目的**：“短剧界的滴滴”——解决剧组急需用人、结算混乱痛点，同时解决大学生兼职安全与保障问题 [cite: 4]。
* [cite_start]**价值主张**：快（2h到岗）、准（标签筛选）、省（流程优化）、安（轨迹追踪） [cite: 5]。

## 2. 用户角色与业务流程
* [cite_start]**需求方（剧组/统筹）**：发布需求 -> 监控位置 -> 确认完工 -> 支付结算 [cite: 7]。
* [cite_start]**供给方（演员/学生）**：接收派单 -> 抢单 -> 行程分享 -> 打卡上工 -> 收款 [cite: 8]。
* [cite_start]**核心闭环**：发单 -> 匹配推送 -> 抢单 -> 履约监控（分场景） -> 现场作业 -> 结算 [cite: 9]。

## 3. 功能模块详解

### 3.1 登录与注册模块
* **身份分流**：
    * **剧组**：需进行企业或项目认证。
    * [cite_start]**演员**：需实名认证 + 学生认证（针对西南大学试点增加学信网接口） [cite: 12]。

### [cite_start]3.2 LBS 任务大厅 (核心重构：发单与定价优化) [cite: 13]
#### 剧组端（发单）
1.  [cite_start]**基础信息**：集合地点、时间、需要人数 [cite: 15]。
2.  [cite_start]**精准筛选**：性别、身高范围、体型、特长（开车/跳舞等） [cite: 16]。
3.  [cite_start]**【新增】待遇福利标签** [cite: 17]：
    * **功能**：勾选项（如“包盒饭”、“包来回车费”、“提供住宿”、“有奶茶/下午茶”）。
    * [cite_start]**作用**：作为“优质订单”权重因子，高福利订单优先推送给高信用/高质量演员 [cite: 19]。
4.  [cite_start]**【优化】费用/定价设置** [cite: 20]：
    * **MVP 阶段策略**：**剧组自主定价**（如填写“100元/天”）。
        * [cite_start]*理由*：前期缺乏数据沉淀，避免算法偏差 [cite: 22]。
    * [cite_start]**未来规划 (VIP)**：基于数据积累（如“重庆-身高180-群演”均价）推出“行业指导价”服务 [cite: 23]。

#### 演员端（接单）
* [cite_start]**展示**：地图/卡片显示距离、角色要求、**高亮福利标签**、剧组出价 [cite: 25]。

### [cite_start]3.3 行程与履约系统 (核心重构：区分“即时单”与“预约单”) [cite: 26]
针对用户反馈，将追踪逻辑拆分为两种模式：

#### [cite_start]模式 A：即时单 (距离集合时间 < 2小时) [cite: 28, 29]
* [cite_start]**追踪逻辑**：演员接单后，**立即开启** LBS 实时定位分享 [cite: 30]。
* [cite_start]**剧组端**：实时在地图上看到演员移动轨迹 [cite: 31]。

#### [cite_start]模式 B：预约单 (距离集合时间 > 2小时) [cite: 32, 33]
* [cite_start]**第一阶段（接单后 - 出发前）**：不开启实时定位，保护隐私，省电。状态显示“待履约” [cite: 36]。
* [cite_start]**第二阶段（触发提醒）**：系统根据路程智能计算，在集合时间前推送强提醒：“您该出发了” [cite: 37]。
* **第三阶段（主动出发）**：
    * [cite_start]演员点击 APP 内 **“我已出发”** 按钮 [cite: 38]。
    * [cite_start]**开启追踪**：点击后，LBS 实时定位正式开启，剧组端收到轨迹 [cite: 39]。
* [cite_start]**异常处理**：若超过“最晚出发时间”未点击，触发电话/短信报警，通知剧组可能迟到 [cite: 40]。

#### 通用逻辑
* [cite_start]**电子围栏打卡**：无论哪种模式，到达现场 100 米内方可点击“上工” [cite: 41]。

### 3.4 结算与钱包系统
* [cite_start]**自动结算**：依据打卡生成的工时单或一口价结算 [cite: 43]。
* [cite_start]**资金记录**：支持查看收入明细 [cite: 44]。

## [cite_start]4. 个人中心与双向信用体系 (核心重构：匹配策略) [cite: 45]

[cite_start]引入“双向匹配权重算法”，激励高分用户 [cite: 49]。

### 4.1 演员信用分 (Actor Score)
* [cite_start]**构成**：履约率（不迟到/不跳单）、剧组评价、违规记录 [cite: 51]。
* **高分权益**：
    * [cite_start]**优先权**：Top 20% 演员比普通演员**提前 3-5 分钟**收到推送 [cite: 53]。
    * [cite_start]**优质单匹配**：优先匹配“高待遇/高福利/高客单价”订单 [cite: 54]。

### 4.2 剧组信用分 (Crew Score)
* [cite_start]**构成**：支付及时性、如实履约、演员评价（态度、福利兑现情况） [cite: 56]。
* **高分权益**：
    * [cite_start]**优选派单**：发单后系统优先推送给“王牌演员” [cite: 58]。
    * [cite_start]**标记展示**：在演员端显示“金牌剧组”徽章 [cite: 59]。

### [cite_start]4.3 匹配逻辑总结 [cite: 60]
* **Best Match**：【高薪/高福利剧组】↔【高信用/高质量演员】（极速撮合）。
* **Low Match**：【低预算/低分剧组】↔【新人/低分演员】（兜底匹配）。

## [cite_start]5. 技术执行关键点 [cite: 63]

### 数据库更新
* [cite_start]`Order_Table`: 新增 `welfare_tags` (JSON: ["meal", "taxi"]), `custom_price` (Decimal), `price_unit` [cite: 65]。
* [cite_start]`User_Table`: 新增 `credit_score_actor`, `credit_score_crew` [cite: 66]。

### LBS 逻辑修改
* [cite_start]**定时任务**：开发延时队列，用于预约单在 T-Time 触发提醒 [cite: 68]。
* [cite_start]**长连接开关**：开发“出发按钮”接口，作为 WebSocket 开启的触发器 [cite: 69]。

### 匹配算法调整
* 废弃单纯 Distance < 5km 逻辑。
* [cite_start]**新公式**：`Score(Actor) * Weight + Distance * Weight`，并加入“优先推送时间差”机制 [cite: 74]。

## [cite_start]6. MVP 下一步计划 [cite: 75]
1.  [cite_start]**UI 调整**：发单页增加“待遇多选框”和“价格输入框” [cite: 76]。
2.  [cite_start]**交互设计**：绘制预约单“待出发 -> 点击出发 -> 开启轨迹”流程图 [cite: 77]。
3.  [cite_start]**调研**：收集常用剧组“福利黑话”预设进标签库 [cite: 78]。